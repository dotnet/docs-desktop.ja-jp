---
title: DataGrid コントロールの概要
ms.date: 03/30/2017
f1_keywords:
- DataGrid
helpviewer_keywords:
- datasets [Windows Forms], binding to DataGrid control
- data binding [Windows Forms], DataGrid control
- columns [Windows Forms], DataGrid control
- data sources [Windows Forms], binding to DataGrid control
- tables [Windows Forms], binding to DataGrid control
- DataGrid control [Windows Forms], data binding
- DataGrid control [Windows Forms], about DataGrid control
- parent tables in DataGrid control
- tables [Windows Forms], displaying in DataGrid control
- data grids [Windows Forms], about data grids
- multiple tables in DataGrid control
- data [Windows Forms], resorting
- data [Windows Forms], navigating
- parent table navigation in DataGrid
- child tables [Windows Forms], dataGrid control
ms.assetid: 85604bce-bc03-49d9-9030-dda8896c44b1
ms.openlocfilehash: df559926dbc9141276f0a03deb99e340fd7212da
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96974237"
---
# <a name="datagrid-control-overview-windows-forms"></a><span data-ttu-id="423de-102">DataGrid コントロールの概要 (Windows フォーム)</span><span class="sxs-lookup"><span data-stu-id="423de-102">DataGrid Control Overview (Windows Forms)</span></span>

> [!NOTE]
> <span data-ttu-id="423de-103"><xref:System.Windows.Forms.DataGridView> コントロールは、<xref:System.Windows.Forms.DataGrid> コントロールに代わると共に追加の機能を提供します。ただし、<xref:System.Windows.Forms.DataGrid> コントロールは、下位互換性を保つ目的および将来使用する目的で保持されます。</span><span class="sxs-lookup"><span data-stu-id="423de-103">The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose.</span></span> <span data-ttu-id="423de-104">詳細については、「[Windows フォームの DataGridView コントロールと DataGrid コントロールの違いについて](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-104">For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).</span></span>

<span data-ttu-id="423de-105">Windows フォーム <xref:System.Windows.Forms.DataGrid> コントロールは、一連の行と列のデータを表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-105">The Windows Forms <xref:System.Windows.Forms.DataGrid> control displays data in a series of rows and columns.</span></span> <span data-ttu-id="423de-106">最も簡単なケースは、リレーションシップを含まない 1 つのテーブルを持つデータ ソースにグリッドがバインドされている場合です。</span><span class="sxs-lookup"><span data-stu-id="423de-106">The simplest case is when the grid is bound to a data source with a single table that contains no relationships.</span></span> <span data-ttu-id="423de-107">その場合は、スプレッドシートのように、単純な行と列でデータが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-107">In that case, the data appears in simple rows and columns, as in a spreadsheet.</span></span> <span data-ttu-id="423de-108">その他のコントロールへのデータ バインディングの詳細については、「[データ連結と Windows フォーム](../data-binding-and-windows-forms.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-108">For more information about binding data to other controls, see [Data Binding and Windows Forms](../data-binding-and-windows-forms.md).</span></span>

<span data-ttu-id="423de-109"><xref:System.Windows.Forms.DataGrid> が複数の関連するテーブルを持つデータにバインドされ、グリッドでナビゲーションが有効な場合は、グリッドの行ごとに展開コントロールが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-109">If the <xref:System.Windows.Forms.DataGrid> is bound to data with multiple related tables, and if navigation is enabled on the grid, the grid will display expanders in each row.</span></span> <span data-ttu-id="423de-110">展開コントロールでは、ユーザーは、親テーブルから子テーブルに移動できます。</span><span class="sxs-lookup"><span data-stu-id="423de-110">With an expander, the user can move from a parent table to a child table.</span></span> <span data-ttu-id="423de-111">ノードをクリックすると子テーブルが表示され、[戻る] ボタンをクリックすると、元の親テーブルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-111">Clicking a node displays the child table, and clicking a back button displays the original parent table.</span></span> <span data-ttu-id="423de-112">この方法では、グリッドはテーブル間の階層リレーションシップを表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-112">In this manner, the grid displays the hierarchical relationships between tables.</span></span>

<span data-ttu-id="423de-113">次のスクリーンショットは、複数のテーブルを持つデータにバインドされた DataGrid を示しています。</span><span class="sxs-lookup"><span data-stu-id="423de-113">The following screenshot shows a DataGrid bound to data with multiple tables:</span></span>

![複数のテーブルを持つデータにバインドされた DataGrid を表示する WinForms アプリ。](./media/datagrid-control-overview-windows-forms/datagrid-bound-multiple-tables.gif)

<span data-ttu-id="423de-115"><xref:System.Windows.Forms.DataGrid> はデータセットのユーザー インターフェイス、関連するテーブル間のナビゲーション、および豊富な書式設定および編集機能を提供することができます。</span><span class="sxs-lookup"><span data-stu-id="423de-115">The <xref:System.Windows.Forms.DataGrid> can provide a user interface for a dataset, navigation between related tables, and rich formatting and editing capabilities.</span></span>

<span data-ttu-id="423de-116">データの表示と操作は個別の機能です。コントロールはユーザーインターフェイスを処理しますが、データ更新は Windows フォームデータバインディングアーキテクチャと .NET Framework データプロバイダーによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="423de-116">The display and manipulation of data are separate functions: The control handles the user interface, whereas data updates are handled by the Windows Forms data-binding architecture and by .NET Framework data providers.</span></span> <span data-ttu-id="423de-117">このため、同じデータ ソースにバインドされる複数のコントロールが同期状態を保ちます。</span><span class="sxs-lookup"><span data-stu-id="423de-117">Therefore, multiple controls bound to the same data source will stay in sync.</span></span>

> [!NOTE]
> <span data-ttu-id="423de-118">Visual Basic 6.0 の DataGrid コントロールに慣れている場合、Windows フォームの <xref:System.Windows.Forms.DataGrid> コントロールには大きな違いがあります。</span><span class="sxs-lookup"><span data-stu-id="423de-118">If you are familiar with the DataGrid control in Visual Basic 6.0, you will find some significant differences in the Windows Forms <xref:System.Windows.Forms.DataGrid> control.</span></span>

<span data-ttu-id="423de-119">グリッドが <xref:System.Data.DataSet> にバインドされると、列と行が自動的に作成、書式設定、および入力されます。</span><span class="sxs-lookup"><span data-stu-id="423de-119">When the grid is bound to a <xref:System.Data.DataSet>, the columns and rows are automatically created, formatted, and filled.</span></span> <span data-ttu-id="423de-120">詳細については、「 [Data Binding and Windows Forms](../data-binding-and-windows-forms.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-120">For more information, see [Data Binding and Windows Forms](../data-binding-and-windows-forms.md).</span></span> <span data-ttu-id="423de-121"><xref:System.Windows.Forms.DataGrid> コントロールの生成に従い、ニーズに応じて列と行を追加、削除、再配置、および書式設定できます。</span><span class="sxs-lookup"><span data-stu-id="423de-121">Following the generation of the <xref:System.Windows.Forms.DataGrid> control, you can add, delete, rearrange, and format columns and rows depending on your needs.</span></span>

## <a name="binding-data-to-the-control"></a><span data-ttu-id="423de-122">コントロールへのデータのバインド</span><span class="sxs-lookup"><span data-stu-id="423de-122">Binding Data to the Control</span></span>

<span data-ttu-id="423de-123"><xref:System.Windows.Forms.DataGrid> コントロールが機能するために、デザイン時に <xref:System.Windows.Forms.DataGrid.DataSource%2A> プロパティと <xref:System.Windows.Forms.DataGrid.DataMember%2A> プロパティを使用して、または実行時に <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> メソッドを使用してデータ ソースにバインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="423de-123">For the <xref:System.Windows.Forms.DataGrid> control to work, it should be bound to a data source using the <xref:System.Windows.Forms.DataGrid.DataSource%2A> and <xref:System.Windows.Forms.DataGrid.DataMember%2A> properties at design time or the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method at run time.</span></span> <span data-ttu-id="423de-124">このバインディングは、<xref:System.Windows.Forms.DataGrid> を <xref:System.Data.DataSet> や <xref:System.Data.DataTable> などのインスタンス化されたデータ ソース オブジェクトにポイントします。</span><span class="sxs-lookup"><span data-stu-id="423de-124">This binding points the <xref:System.Windows.Forms.DataGrid> to an instantiated data-source object, such as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable>).</span></span> <span data-ttu-id="423de-125"><xref:System.Windows.Forms.DataGrid> コントロールは、データ上で実行されるアクションの結果を表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-125">The <xref:System.Windows.Forms.DataGrid> control shows the results of actions that are performed on the data.</span></span> <span data-ttu-id="423de-126">ほとんどのデータに固有の動作は、<xref:System.Windows.Forms.DataGrid> によってではなく、データ ソースによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="423de-126">Most data-specific actions are not performed through the <xref:System.Windows.Forms.DataGrid> , but instead through the data source.</span></span>

<span data-ttu-id="423de-127">バインドされたデータセット内のデータが任意のメカニズムにより更新された場合に、 <xref:System.Windows.Forms.DataGrid> コントロールが変更を反映します。</span><span class="sxs-lookup"><span data-stu-id="423de-127">If the data in the bound dataset is updated through any mechanism, the <xref:System.Windows.Forms.DataGrid> control reflects the changes.</span></span> <span data-ttu-id="423de-128">データグリッドとそのテーブルのスタイルおよび列のスタイルでプロパティがに設定されている場合 `ReadOnly` `false` 、データセット内のデータはコントロールを使用して更新でき <xref:System.Windows.Forms.DataGrid> ます。</span><span class="sxs-lookup"><span data-stu-id="423de-128">If the data grid and its table styles and column styles have the `ReadOnly` property set to `false`, the data in the dataset can be updated through the <xref:System.Windows.Forms.DataGrid> control.</span></span>

<span data-ttu-id="423de-129"><xref:System.Windows.Forms.DataGrid> には、一度に 1 つのテーブルのみを表示できます。</span><span class="sxs-lookup"><span data-stu-id="423de-129">Only one table can be shown in the <xref:System.Windows.Forms.DataGrid> at a time.</span></span> <span data-ttu-id="423de-130">テーブル間で親子のリレーションシップが定義される場合、ユーザーが関連するテーブルの間で移動して、<xref:System.Windows.Forms.DataGrid> コントロールで表示されるテーブルを選択できます。</span><span class="sxs-lookup"><span data-stu-id="423de-130">If a parent-child relationship is defined between tables, the user can move between the related tables to select the table to be displayed in the <xref:System.Windows.Forms.DataGrid> control.</span></span> <span data-ttu-id="423de-131"><xref:System.Windows.Forms.DataGrid>デザイン時または実行時に ADO.NET データソースにコントロールをバインドする方法については、「[方法: データソースに Windows フォーム DataGrid コントロールをバインドする](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-131">For information about binding a <xref:System.Windows.Forms.DataGrid> control to an ADO.NET data source at either design time or run time, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md).</span></span>

<span data-ttu-id="423de-132"><xref:System.Windows.Forms.DataGrid> の有効なデータ ソースには、次が含まれます。</span><span class="sxs-lookup"><span data-stu-id="423de-132">Valid data sources for the <xref:System.Windows.Forms.DataGrid> include:</span></span>

- <span data-ttu-id="423de-133"><xref:System.Data.DataTable> クラス</span><span class="sxs-lookup"><span data-stu-id="423de-133"><xref:System.Data.DataTable> class</span></span>

- <span data-ttu-id="423de-134"><xref:System.Data.DataView> クラス</span><span class="sxs-lookup"><span data-stu-id="423de-134"><xref:System.Data.DataView> class</span></span>

- <span data-ttu-id="423de-135"><xref:System.Data.DataSet> クラス</span><span class="sxs-lookup"><span data-stu-id="423de-135"><xref:System.Data.DataSet> class</span></span>

- <span data-ttu-id="423de-136"><xref:System.Data.DataViewManager> クラス</span><span class="sxs-lookup"><span data-stu-id="423de-136"><xref:System.Data.DataViewManager> class</span></span>

<span data-ttu-id="423de-137">ソースがデータセットの場合、データセットは、フォーム内のオブジェクト、または XML Web サービスによってフォームに渡されるオブジェクトの可能性があります。</span><span class="sxs-lookup"><span data-stu-id="423de-137">If your source is a dataset, the dataset might be an object in the form or an object passed to the form by an XML Web service.</span></span> <span data-ttu-id="423de-138">型指定されたか、型指定されていないデータセットにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="423de-138">You can bind to either typed or untyped datasets.</span></span>

<span data-ttu-id="423de-139">配列内の要素など、構造内のオブジェクトがパブリック プロパティを公開する場合は、<xref:System.Windows.Forms.DataGrid> コントロールを追加の構造にバインドすることもできます。</span><span class="sxs-lookup"><span data-stu-id="423de-139">You can also bind a <xref:System.Windows.Forms.DataGrid> control to additional structures if the objects in the structure, such as the elements in an array, expose public properties.</span></span> <span data-ttu-id="423de-140">グリッドには、構造内の要素のすべてのパブリック プロパティが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-140">The grid will display all the public properties of the elements in the structure.</span></span> <span data-ttu-id="423de-141">たとえば、<xref:System.Windows.Forms.DataGrid> コントロールを顧客オブジェクトの配列にバインドする場合、グリッドにこれらの顧客オブジェクトのすべてのパブリック プロパティが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-141">For example, if you bind the <xref:System.Windows.Forms.DataGrid> control to an array of customer objects, the grid will display all the public properties of those customer objects.</span></span> <span data-ttu-id="423de-142">場合によっては、構造にバインドすることができますが、結果としてバインドされている構造が、実際のアプリケーションを持たない可能性があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="423de-142">In some instances, this means that although you can bind to the structure, the resulting bound structure might not have practical application.</span></span> <span data-ttu-id="423de-143">たとえば、整数の配列にバインドできますが、`Integer` データ型はパブリック プロパティをサポートしないため、グリッドがすべてのデータを表示できません。</span><span class="sxs-lookup"><span data-stu-id="423de-143">For example, you can bind to an array of integers, but because the `Integer` data type does not support a public property, the grid cannot display any data.</span></span>

<span data-ttu-id="423de-144">要素がパブリック プロパティを公開する場合は、次の構造にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="423de-144">You can bind to the following structures if their elements expose public properties:</span></span>

- <span data-ttu-id="423de-145"><xref:System.Collections.IList> インターフェイスを実装するコンポーネント。</span><span class="sxs-lookup"><span data-stu-id="423de-145">Any component that implements the <xref:System.Collections.IList> interface.</span></span> <span data-ttu-id="423de-146">これには 1 次元の配列が含まれます。</span><span class="sxs-lookup"><span data-stu-id="423de-146">This includes single-dimension arrays.</span></span>

- <span data-ttu-id="423de-147"><xref:System.ComponentModel.IListSource> インターフェイスを実装するコンポーネント。</span><span class="sxs-lookup"><span data-stu-id="423de-147">Any component that implements the <xref:System.ComponentModel.IListSource> interface.</span></span>

- <span data-ttu-id="423de-148"><xref:System.ComponentModel.IBindingList> インターフェイスを実装するコンポーネント。</span><span class="sxs-lookup"><span data-stu-id="423de-148">Any component that implements the <xref:System.ComponentModel.IBindingList> interface.</span></span>

 <span data-ttu-id="423de-149">使用できるデータ ソースの詳細については、「[Windows フォームがサポートするデータ ソース](../data-sources-supported-by-windows-forms.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-149">For more information about possible data sources, see [Data Sources Supported by Windows Forms](../data-sources-supported-by-windows-forms.md).</span></span>

## <a name="grid-display"></a><span data-ttu-id="423de-150">グリッドの表示</span><span class="sxs-lookup"><span data-stu-id="423de-150">Grid Display</span></span>

<span data-ttu-id="423de-151"><xref:System.Windows.Forms.DataGrid> コントロールの一般的な使い方は、データセットからデータの 1 つのテーブルを表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-151">A common use of the <xref:System.Windows.Forms.DataGrid> control is to display a single table of data from a dataset.</span></span> <span data-ttu-id="423de-152">ただし、関連テーブルを含む複数のテーブルを表示するためにコントロールを使用できます。</span><span class="sxs-lookup"><span data-stu-id="423de-152">However, the control can also be used to display multiple tables, including related tables.</span></span> <span data-ttu-id="423de-153">グリッドの表示は、データ ソースに応じて自動的に調整されます。</span><span class="sxs-lookup"><span data-stu-id="423de-153">The display of the grid is adjusted automatically according to the data source.</span></span> <span data-ttu-id="423de-154">さまざまな構成で表示される内容を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="423de-154">The following table shows what is displayed for various configurations.</span></span>

|<span data-ttu-id="423de-155">データ セットの内容</span><span class="sxs-lookup"><span data-stu-id="423de-155">Contents of data set</span></span>|<span data-ttu-id="423de-156">表示される内容</span><span class="sxs-lookup"><span data-stu-id="423de-156">What is displayed</span></span>|
|--------------------------|-----------------------|
|<span data-ttu-id="423de-157">1 つのテーブル。</span><span class="sxs-lookup"><span data-stu-id="423de-157">Single table.</span></span>|<span data-ttu-id="423de-158">テーブルがグリッドに表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-158">Table is displayed in a grid.</span></span>|
|<span data-ttu-id="423de-159">複数のテーブル。</span><span class="sxs-lookup"><span data-stu-id="423de-159">Multiple tables.</span></span>|<span data-ttu-id="423de-160">グリッドに、ユーザーが移動して表示するテーブルを検索できるツリー ビューを表示できます。</span><span class="sxs-lookup"><span data-stu-id="423de-160">The grid can display a tree view that users can navigate to locate the table they want to display.</span></span>|
|<span data-ttu-id="423de-161">複数の関連テーブル。</span><span class="sxs-lookup"><span data-stu-id="423de-161">Multiple related tables.</span></span>|<span data-ttu-id="423de-162">グリッドに、テーブルを選択するツリー ビューを表示でき、グリッドに親テーブルを表示するよう指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="423de-162">The grid can display a tree view to select tables with, or you can specify that the grid display the parent table.</span></span> <span data-ttu-id="423de-163">親テーブル内のレコードでは、ユーザーが関連する子の行に移動できます。</span><span class="sxs-lookup"><span data-stu-id="423de-163">Records in the parent table let users navigate to related child rows.</span></span>|

> [!NOTE]
> <span data-ttu-id="423de-164">データセットのテーブルは、<xref:System.Data.DataRelation> を使用して関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="423de-164">Tables in a dataset are related using a <xref:System.Data.DataRelation>.</span></span> <span data-ttu-id="423de-165">「 [データセット間のリレーションシップの作成](/visualstudio/data-tools/relationships-in-datasets)」も参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-165">Also see [Create relationships between datasets](/visualstudio/data-tools/relationships-in-datasets).</span></span>

<span data-ttu-id="423de-166"><xref:System.Windows.Forms.DataGrid> コントロールがテーブルに表示され、<xref:System.Windows.Forms.DataGrid.AllowSorting%2A> プロパティが `true` に設定される場合、データは列ヘッダーをクリックして再度並べ替えることができます。</span><span class="sxs-lookup"><span data-stu-id="423de-166">When the <xref:System.Windows.Forms.DataGrid> control is displaying a table and the <xref:System.Windows.Forms.DataGrid.AllowSorting%2A> property is set to `true`, data can be resorted by clicking the column headers.</span></span> <span data-ttu-id="423de-167">ユーザーは行の追加やセルの編集も実行できます。</span><span class="sxs-lookup"><span data-stu-id="423de-167">The user can also add rows and edit cells.</span></span>

<span data-ttu-id="423de-168">一連のテーブル間のリレーションシップは、ナビゲーションの親/子構造体を使用してユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-168">The relationships between a set of tables are displayed to users by using a parent/child structure of navigation.</span></span> <span data-ttu-id="423de-169">親テーブルは最高レベルのデータ、および子テーブルは、親テーブルの個別の一覧から派生した個々 のデータ テーブルです。</span><span class="sxs-lookup"><span data-stu-id="423de-169">Parent tables are the highest level of data, and child tables are those data tables that are derived from the individual listings in the parent tables.</span></span> <span data-ttu-id="423de-170">展開コントロールは、子テーブルを含む各親の行に表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-170">Expanders are displayed in each parent row that contains a child table.</span></span> <span data-ttu-id="423de-171">展開コントロールをクリックすると、子テーブルへの Web のようなリンクの一覧が生成されます。</span><span class="sxs-lookup"><span data-stu-id="423de-171">Clicking an expander generates a list of Web-like links to the child tables.</span></span> <span data-ttu-id="423de-172">ユーザーがリンクを選択すると、子テーブルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-172">When the user selects a link, the child table is displayed.</span></span> <span data-ttu-id="423de-173">[親行の表示/非表示] アイコン (</span><span class="sxs-lookup"><span data-stu-id="423de-173">Clicking the show/hide parent rows icon (</span></span>![[親行の表示/非表示] アイコン](./media/datagrid-control-overview-windows-forms/show-hide-parent-rows.gif)<span data-ttu-id="423de-175">) を実行すると、親テーブルに関する情報が非表示になり、ユーザーが以前に非表示にした場合は再表示されます。</span><span class="sxs-lookup"><span data-stu-id="423de-175">) will hide the information about the parent table or cause it to reappear if the user has previously hidden it.</span></span> <span data-ttu-id="423de-176">ユーザーは、戻るボタンをクリックして、前に表示されていたテーブルに移動することができます。</span><span class="sxs-lookup"><span data-stu-id="423de-176">The user can click a back button to move back to the previously viewed table.</span></span>

## <a name="columns-and-rows"></a><span data-ttu-id="423de-177">列と行</span><span class="sxs-lookup"><span data-stu-id="423de-177">Columns and Rows</span></span>

<span data-ttu-id="423de-178"><xref:System.Windows.Forms.DataGrid> は、<xref:System.Windows.Forms.DataGrid> コントロールの <xref:System.Windows.Forms.DataGrid.TableStyles%2A> プロパティに含まれる <xref:System.Windows.Forms.DataGridTableStyle> オブジェクトのコレクションから構成されます。</span><span class="sxs-lookup"><span data-stu-id="423de-178">The <xref:System.Windows.Forms.DataGrid> consists of a collection of <xref:System.Windows.Forms.DataGridTableStyle> objects that are contained in the <xref:System.Windows.Forms.DataGrid> control's <xref:System.Windows.Forms.DataGrid.TableStyles%2A> property.</span></span> <span data-ttu-id="423de-179">テーブルのスタイルには、<xref:System.Windows.Forms.DataGridTableStyle> の <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> プロパティに含まれる <xref:System.Windows.Forms.DataGridColumnStyle> オブジェクトのコレクションが含まれる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="423de-179">A table style may contain a collection of <xref:System.Windows.Forms.DataGridColumnStyle> objects that are contained in the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property of the <xref:System.Windows.Forms.DataGridTableStyle>..</span></span> <span data-ttu-id="423de-180"><xref:System.Windows.Forms.DataGrid.TableStyles%2A> <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> プロパティとプロパティは、[**プロパティ**] ウィンドウからアクセスするコレクションエディターを使用して編集できます。</span><span class="sxs-lookup"><span data-stu-id="423de-180">You can edit the <xref:System.Windows.Forms.DataGrid.TableStyles%2A> and <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> properties by using collection editors accessed through the **Properties** window.</span></span>

<span data-ttu-id="423de-181"><xref:System.Windows.Forms.DataGrid> コントロールに関連付けられている任意の <xref:System.Windows.Forms.DataGridTableStyle> は <xref:System.Windows.Forms.GridTableStylesCollection> によってアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="423de-181">Any <xref:System.Windows.Forms.DataGridTableStyle> associated with the <xref:System.Windows.Forms.DataGrid> control can be accessed through the <xref:System.Windows.Forms.GridTableStylesCollection>.</span></span> <span data-ttu-id="423de-182"><xref:System.Windows.Forms.GridTableStylesCollection> は、<xref:System.Windows.Forms.DataGridTableStyle> コレクション エディターを使用してデザイナーで編集することも、<xref:System.Windows.Forms.DataGrid> コントロールの <xref:System.Windows.Forms.DataGrid.TableStyles%2A> プロパティからプログラムで編集することもできます。</span><span class="sxs-lookup"><span data-stu-id="423de-182">The <xref:System.Windows.Forms.GridTableStylesCollection> can be edited in the designer with the <xref:System.Windows.Forms.DataGridTableStyle> collection editor, or programmatically through the <xref:System.Windows.Forms.DataGrid> control's <xref:System.Windows.Forms.DataGrid.TableStyles%2A> property.</span></span>

<span data-ttu-id="423de-183">次の図は、DataGrid コントロールに含まれるオブジェクトを示しています。</span><span class="sxs-lookup"><span data-stu-id="423de-183">The following illustration shows the objects included in the DataGrid control:</span></span>

![DataGrid コントロールに含まれるオブジェクトを示す図。](./media/datagrid-control-overview-windows-forms/visual-basic-columns.gif)

<span data-ttu-id="423de-185">テーブルのスタイルおよび列のスタイルは、`MappingName` プロパティを適切な <xref:System.Data.DataTable.TableName%2A> プロパティと <xref:System.Data.DataColumn.ColumnName%2A> プロパティに設定することで <xref:System.Data.DataTable> オブジェクトおよび <xref:System.Data.DataColumn> オブジェクトと同期されます。</span><span class="sxs-lookup"><span data-stu-id="423de-185">Table styles and column styles are synchronized with <xref:System.Data.DataTable> objects and <xref:System.Data.DataColumn> objects by setting their `MappingName` properties to the appropriate <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataColumn.ColumnName%2A> properties.</span></span> <span data-ttu-id="423de-186">列のスタイルを持たない <xref:System.Windows.Forms.DataGridTableStyle> が、有効なデータ ソースにバインドされた <xref:System.Windows.Forms.DataGrid> コントロールに追加され、テーブルのスタイルの <xref:System.Windows.Forms.DataGridTableStyle.MappingName%2A> プロパティが有効な <xref:System.Data.DataTable.TableName%2A> プロパティに設定される場合に、<xref:System.Windows.Forms.DataGridColumnStyle> オブジェクトのコレクションが、そのテーブルのスタイルに対して作成されます。</span><span class="sxs-lookup"><span data-stu-id="423de-186">When a <xref:System.Windows.Forms.DataGridTableStyle> that has no column styles is added to a <xref:System.Windows.Forms.DataGrid> control bound to a valid data source, and the <xref:System.Windows.Forms.DataGridTableStyle.MappingName%2A> property of that table style is set to a valid <xref:System.Data.DataTable.TableName%2A> property, a collection of <xref:System.Windows.Forms.DataGridColumnStyle> objects is created for that table style.</span></span> <span data-ttu-id="423de-187"><xref:System.Data.DataTable> の <xref:System.Data.DataTable.Columns%2A> のコレクションで見つかった各 <xref:System.Data.DataColumn> に対して、対応する <xref:System.Windows.Forms.DataGridColumnStyle> が <xref:System.Windows.Forms.GridColumnStylesCollection> に追加されます。</span><span class="sxs-lookup"><span data-stu-id="423de-187">For each <xref:System.Data.DataColumn> found in the <xref:System.Data.DataTable.Columns%2A> collection of the <xref:System.Data.DataTable>, a corresponding <xref:System.Windows.Forms.DataGridColumnStyle> is added to the <xref:System.Windows.Forms.GridColumnStylesCollection>.</span></span> <span data-ttu-id="423de-188"><xref:System.Windows.Forms.GridColumnStylesCollection> は、<xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> の <xref:System.Windows.Forms.DataGridTableStyle> プロパティによりアクセスされます。</span><span class="sxs-lookup"><span data-stu-id="423de-188"><xref:System.Windows.Forms.GridColumnStylesCollection> is accessed through the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property of the <xref:System.Windows.Forms.DataGridTableStyle>.</span></span> <span data-ttu-id="423de-189"><xref:System.Windows.Forms.GridColumnStylesCollection> で <xref:System.Windows.Forms.GridColumnStylesCollection.Add%2A> メソッドまたは <xref:System.Windows.Forms.GridColumnStylesCollection.Remove%2A> メソッドを使用して、列をグリッドに追加または削除できます。</span><span class="sxs-lookup"><span data-stu-id="423de-189">Columns can be added or deleted from the grid using the <xref:System.Windows.Forms.GridColumnStylesCollection.Add%2A> or <xref:System.Windows.Forms.GridColumnStylesCollection.Remove%2A> method on the <xref:System.Windows.Forms.GridColumnStylesCollection>.</span></span> <span data-ttu-id="423de-190">詳細については、「[方法 : Windows フォーム DataGrid コントロールにテーブルと列を追加する](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)」および「[方法 : Windows フォーム DataGrid コントロールの列を削除するまたは非表示にする](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-190">For more information, see [How to: Add Tables and Columns to the Windows Forms DataGrid Control](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md) and [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md).</span></span>

<span data-ttu-id="423de-191">列の型のコレクションは、豊富な書式設定と編集機能を持つ <xref:System.Windows.Forms.DataGridColumnStyle> クラスを拡張します。</span><span class="sxs-lookup"><span data-stu-id="423de-191">A collection of column types extends the <xref:System.Windows.Forms.DataGridColumnStyle> class with rich formatting and editing capabilities.</span></span> <span data-ttu-id="423de-192">すべての列の型は、<xref:System.Windows.Forms.DataGridColumnStyle> 基底クラスから継承します。</span><span class="sxs-lookup"><span data-stu-id="423de-192">All column types inherit from the <xref:System.Windows.Forms.DataGridColumnStyle> base class.</span></span> <span data-ttu-id="423de-193">作成されるクラスは、<xref:System.Web.UI.WebControls.DataGridColumn> の基底である <xref:System.Data.DataColumn> の <xref:System.Data.DataColumn.DataType%2A> プロパティに依存します。</span><span class="sxs-lookup"><span data-stu-id="423de-193">The class that is created depends on the <xref:System.Data.DataColumn.DataType%2A> property of the <xref:System.Data.DataColumn> from which the <xref:System.Web.UI.WebControls.DataGridColumn> is based.</span></span> <span data-ttu-id="423de-194">たとえば、<xref:System.Data.DataColumn.DataType%2A> プロパティが <xref:System.Boolean> に設定された <xref:System.Data.DataColumn> は、<xref:System.Windows.Forms.DataGridBoolColumn> に関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="423de-194">For example, a <xref:System.Data.DataColumn> that has its <xref:System.Data.DataColumn.DataType%2A> property set to <xref:System.Boolean> will be associated with the <xref:System.Windows.Forms.DataGridBoolColumn>.</span></span> <span data-ttu-id="423de-195">各列の型に関する説明を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="423de-195">The following table describes each of these column types.</span></span>

|<span data-ttu-id="423de-196">列の型</span><span class="sxs-lookup"><span data-stu-id="423de-196">Column Type</span></span>|<span data-ttu-id="423de-197">説明</span><span class="sxs-lookup"><span data-stu-id="423de-197">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Windows.Forms.DataGridTextBoxColumn>|<span data-ttu-id="423de-198">書式設定された文字列、または書式設定されていない文字列としてデータを受け入れて表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-198">Accepts and displays data as formatted or unformatted strings.</span></span> <span data-ttu-id="423de-199">編集機能は、単純な <xref:System.Windows.Forms.TextBox> 内のデータを編集する場合と同じです。</span><span class="sxs-lookup"><span data-stu-id="423de-199">Editing capabilities are the same as they are for editing data in a simple <xref:System.Windows.Forms.TextBox>.</span></span> <span data-ttu-id="423de-200"><xref:System.Windows.Forms.DataGridColumnStyle> から継承されます。</span><span class="sxs-lookup"><span data-stu-id="423de-200">Inherits from <xref:System.Windows.Forms.DataGridColumnStyle>.</span></span>|
|<xref:System.Windows.Forms.DataGridBoolColumn>|<span data-ttu-id="423de-201">`true`、`false`、および null 値を受け入れて表示します。</span><span class="sxs-lookup"><span data-stu-id="423de-201">Accepts and displays `true`, `false`, and null values.</span></span> <span data-ttu-id="423de-202"><xref:System.Windows.Forms.DataGridColumnStyle> から継承されます。</span><span class="sxs-lookup"><span data-stu-id="423de-202">Inherits from <xref:System.Windows.Forms.DataGridColumnStyle>.</span></span>|

<span data-ttu-id="423de-203">列の右端をダブルクリックすると、完全キャプションと最も幅の広いエントリを表示するよう列のサイズを変更します。</span><span class="sxs-lookup"><span data-stu-id="423de-203">Double-clicking the right edge of a column resizes the column to display its full caption and widest entry.</span></span>

## <a name="table-styles-and-column-styles"></a><span data-ttu-id="423de-204">テーブルのスタイルおよび列のスタイル</span><span class="sxs-lookup"><span data-stu-id="423de-204">Table Styles and Column Styles</span></span>

<span data-ttu-id="423de-205"><xref:System.Windows.Forms.DataGrid> コントロールの既定の形式が確立されると、すぐに、データ グリッド内に特定のテーブルが表示される場合に使用される色をカスタマイズすることができます。</span><span class="sxs-lookup"><span data-stu-id="423de-205">As soon as you have established the default format of the <xref:System.Windows.Forms.DataGrid> control, you can customize the colors that will be used when certain tables are displayed within the data grid.</span></span>

<span data-ttu-id="423de-206">これは、<xref:System.Windows.Forms.DataGridTableStyle> クラスのインスタンスを作成することによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="423de-206">This is achieved by creating instances of the <xref:System.Windows.Forms.DataGridTableStyle> class.</span></span> <span data-ttu-id="423de-207">テーブルのスタイルは、<xref:System.Windows.Forms.DataGrid> コントロール自体の既定の書式設定とは異なる特定のテーブルの書式設定を指定します。</span><span class="sxs-lookup"><span data-stu-id="423de-207">Table styles specify the formatting of specific tables, distinct from the default formatting of the <xref:System.Windows.Forms.DataGrid> control itself.</span></span> <span data-ttu-id="423de-208">各テーブルは、定義されたテーブルのスタイルを一度に 1 つのみ持つことができます。</span><span class="sxs-lookup"><span data-stu-id="423de-208">Each table may have only one table style defined for it at a time.</span></span>

<span data-ttu-id="423de-209">場合によっては、特定の列の外観を、特定のデータ テーブルの列の残りの部分と異なるものにすることが望ましい場合があります。</span><span class="sxs-lookup"><span data-stu-id="423de-209">Sometimes, you will want to have a specific column look different from the rest of the columns of a particular data table.</span></span> <span data-ttu-id="423de-210"><xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> プロパティを使用して、カスタマイズされた一連の列のスタイルを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="423de-210">You can create a customized set of column styles by using the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property.</span></span>

<span data-ttu-id="423de-211">列のスタイルは、表のスタイルがデータ テーブルに関連するのと同じように、データセット内の列に関連します。</span><span class="sxs-lookup"><span data-stu-id="423de-211">Column styles are related to columns in a dataset just like table styles are related to data tables.</span></span> <span data-ttu-id="423de-212">各テーブルに一度に 1 つの表のスタイルのみ定義できるように、各列も、特定のテーブルのスタイルで一度に 1 つの列のスタイルのみ定義できます。</span><span class="sxs-lookup"><span data-stu-id="423de-212">Just as each table may only have one table style defined for it at a time, so too can each column only have one column style defined for it, in a particular table style.</span></span> <span data-ttu-id="423de-213">このリレーションシップは、列の <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> プロパティで定義されます。</span><span class="sxs-lookup"><span data-stu-id="423de-213">This relationship is defined in the column's <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> property.</span></span>

<span data-ttu-id="423de-214">列のスタイルを追加せずにテーブルスタイルを作成した場合、実行時にフォームとグリッドが作成されると、Visual Studio によって既定の列スタイルが追加されます。</span><span class="sxs-lookup"><span data-stu-id="423de-214">If you have created a table style without column styles added to it, Visual Studio will add default column styles when the form and grid are created at run time.</span></span> <span data-ttu-id="423de-215">ただし、テーブルスタイルを作成し、列スタイルを追加した場合、Visual Studio は列スタイルを作成しません。</span><span class="sxs-lookup"><span data-stu-id="423de-215">However, if you have created a table style and added any column styles to it, Visual Studio will not create any column styles.</span></span> <span data-ttu-id="423de-216">また、列のスタイルを定義し、マッピングの名前に割り当てて、グリッドに表示する列を持つようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="423de-216">Also, you will need to define column styles and assign them with the mapping name to have the columns that you want appear in the grid.</span></span>

<span data-ttu-id="423de-217">列のスタイルに列を割り当てることでデータ グリッドに含まれる列を指定し、列に割り当てられた列のスタイルがないため、グリッドに表示されていないデータセットのデータの列を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="423de-217">Because you specify which columns are included in the data grid by assigning them a column style and no column style has been assigned to the columns, you can include columns of data in the dataset that are not displayed in the grid.</span></span> <span data-ttu-id="423de-218">ただし、データセットにデータ列が含まれているため、表示されていないデータをプログラムで編集できます。</span><span class="sxs-lookup"><span data-stu-id="423de-218">However, because the data column is included in the dataset, you can programmatically edit the data that is not displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="423de-219">一般に、表のスタイルをテーブル スタイルのコレクションに追加する前に、列のスタイルを作成し、列のスタイルのコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="423de-219">In general, create column styles and add them to the column styles collection before adding table styles to the table styles collection.</span></span> <span data-ttu-id="423de-220">コレクションに空のテーブルのスタイルを追加すると、列のスタイルが自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="423de-220">When you add an empty table style to the collection, column styles are automatically generated for you.</span></span> <span data-ttu-id="423de-221">その結果、重複する <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> 値を持つ新しい列のスタイルを列のスタイルのコレクションに追加しようとする場合に例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="423de-221">Consequently, an exception will be thrown if you try to add new column styles with duplicate <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> values to the column styles collection.</span></span>
>
> <span data-ttu-id="423de-222">多くの列の中で 1 つのだけ列を微調整することが望ましい場合があります。たとえば、50 の列がデータセットに含まれていて、そのうち 49 のみが必要だとします。</span><span class="sxs-lookup"><span data-stu-id="423de-222">Sometimes, you will want to just tweak one column among many columns; for example, the dataset contains 50 columns and you only want 49 of them.</span></span> <span data-ttu-id="423de-223">この場合は、プログラムでの 49 個の列をそれぞれプログラムで追加するより、50 のすべての列をインポートし、1 つをプログラムで削除する方が簡単です。</span><span class="sxs-lookup"><span data-stu-id="423de-223">In this case, it is easier to import all 50 columns and programmatically remove one, rather than programmatically adding each of the 49 individual columns you want.</span></span>

## <a name="formatting"></a><span data-ttu-id="423de-224">書式設定</span><span class="sxs-lookup"><span data-stu-id="423de-224">Formatting</span></span>

<span data-ttu-id="423de-225"><xref:System.Windows.Forms.DataGrid> コントロールに適用できる書式設定には、罫線のスタイル、グリッド線のスタイル、フォント、caption プロパティ、データの配置、および行の間の背景色を交互に変える設定が含まれます。</span><span class="sxs-lookup"><span data-stu-id="423de-225">Formatting that can be applied to the <xref:System.Windows.Forms.DataGrid> control includes border styles, gridline styles, fonts, caption properties, data alignment, and alternating background colors between rows.</span></span> <span data-ttu-id="423de-226">詳細については、「[方法 : Windows フォーム DataGrid コントロールの書式を設定する](how-to-format-the-windows-forms-datagrid-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="423de-226">For more information, see [How to: Format the Windows Forms DataGrid Control](how-to-format-the-windows-forms-datagrid-control.md).</span></span>

## <a name="events"></a><span data-ttu-id="423de-227">イベント</span><span class="sxs-lookup"><span data-stu-id="423de-227">Events</span></span>

<span data-ttu-id="423de-228"><xref:System.Windows.Forms.Control.MouseDown>、<xref:System.Windows.Forms.Control.Enter>、および <xref:System.Windows.Forms.DataGrid.Scroll> などの一般的なコントロール イベントのほかに、<xref:System.Windows.Forms.DataGrid> コントロールはグリッド内の編集と移動に関連付けられたイベントをサポートします。</span><span class="sxs-lookup"><span data-stu-id="423de-228">Besides the common control events such as <xref:System.Windows.Forms.Control.MouseDown>, <xref:System.Windows.Forms.Control.Enter>, and <xref:System.Windows.Forms.DataGrid.Scroll>, the <xref:System.Windows.Forms.DataGrid> control supports events associated with editing and navigation within the grid.</span></span> <span data-ttu-id="423de-229"><xref:System.Windows.Forms.DataGrid.CurrentCell%2A> プロパティは、どのセルが選択されるか決定します。</span><span class="sxs-lookup"><span data-stu-id="423de-229">The <xref:System.Windows.Forms.DataGrid.CurrentCell%2A> property determines which cell is selected.</span></span> <span data-ttu-id="423de-230"><xref:System.Windows.Forms.DataGrid.CurrentCellChanged> イベントは、ユーザーが新しいセルに移動するときに発生します。</span><span class="sxs-lookup"><span data-stu-id="423de-230">The <xref:System.Windows.Forms.DataGrid.CurrentCellChanged> event is raised when the user navigates to a new cell.</span></span> <span data-ttu-id="423de-231">ユーザーが親子のリレーションを使用して新しいテーブルに移動するときに、<xref:System.Windows.Forms.DataGrid.Navigate> イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="423de-231">When the user navigates to a new table through parent/child relations, the <xref:System.Windows.Forms.DataGrid.Navigate> event is raised.</span></span> <span data-ttu-id="423de-232"><xref:System.Windows.Forms.DataGrid.BackButtonClick> イベントは、ユーザーが子テーブルを表示している場合にユーザーが [戻る] ボタンをクリックすると発生し、<xref:System.Windows.Forms.DataGrid.ShowParentDetailsButtonClick> イベントは、親行の表示/非表示のアイコンをクリックすると発生します。</span><span class="sxs-lookup"><span data-stu-id="423de-232">The <xref:System.Windows.Forms.DataGrid.BackButtonClick> event is raised when the user clicks the back button when the user is viewing a child table, and the <xref:System.Windows.Forms.DataGrid.ShowParentDetailsButtonClick> event is raised when the show/hide parent rows icon is clicked.</span></span>

## <a name="see-also"></a><span data-ttu-id="423de-233">関連項目</span><span class="sxs-lookup"><span data-stu-id="423de-233">See also</span></span>

- [<span data-ttu-id="423de-234">DataGrid コントロール</span><span class="sxs-lookup"><span data-stu-id="423de-234">DataGrid Control</span></span>](datagrid-control-windows-forms.md)
- [<span data-ttu-id="423de-235">方法: データ ソースに Windows フォーム DataGrid コントロールをバインドする</span><span class="sxs-lookup"><span data-stu-id="423de-235">How to: Bind the Windows Forms DataGrid Control to a Data Source</span></span>](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)
- [<span data-ttu-id="423de-236">方法: Windows フォーム DataGrid コントロールにテーブルと列を追加する</span><span class="sxs-lookup"><span data-stu-id="423de-236">How to: Add Tables and Columns to the Windows Forms DataGrid Control</span></span>](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)
- [<span data-ttu-id="423de-237">方法: Windows フォーム DataGrid コントロールの列を削除するまたは非表示にする</span><span class="sxs-lookup"><span data-stu-id="423de-237">How to: Delete or Hide Columns in the Windows Forms DataGrid Control</span></span>](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)
- [<span data-ttu-id="423de-238">方法: Windows フォーム DataGrid コントロールの書式を設定する</span><span class="sxs-lookup"><span data-stu-id="423de-238">How to: Format the Windows Forms DataGrid Control</span></span>](how-to-format-the-windows-forms-datagrid-control.md)
