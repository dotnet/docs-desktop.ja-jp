---
title: MenuStrip コントロールでのメニュー項目のマージ
ms.date: 03/30/2017
helpviewer_keywords:
- MenuStrip [Windows Forms], merging
- merging [Windows Forms], general concepts
ms.assetid: 95e113ba-f362-4dda-8a76-6d95ddc45cee
ms.openlocfilehash: 9fc2b40ef23d72db51853c124095b734a7646cda
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96982927"
---
# <a name="merging-menu-items-in-the-windows-forms-menustrip-control"></a><span data-ttu-id="8208f-102">Windows フォームの MenuStrip コントロールへのメニュー項目のマージ</span><span class="sxs-lookup"><span data-stu-id="8208f-102">Merging Menu Items in the Windows Forms MenuStrip Control</span></span>
<span data-ttu-id="8208f-103">マルチドキュメントインターフェイス (MDI) アプリケーションを使用している場合は、メニュー項目またはメニュー全体を子フォームから親フォームのメニューにマージできます。</span><span class="sxs-lookup"><span data-stu-id="8208f-103">If you have a multiple-document interface (MDI) application, you can merge menu items or whole menus from the child form into the menus of the parent form.</span></span>  
  
 <span data-ttu-id="8208f-104">このトピックでは、MDI アプリケーションでのメニュー項目のマージに関連する基本的な概念について説明します。</span><span class="sxs-lookup"><span data-stu-id="8208f-104">This topic describes the basic concepts associated with merging menu items in an MDI application.</span></span>  
  
## <a name="general-concepts"></a><span data-ttu-id="8208f-105">一般的な概念</span><span class="sxs-lookup"><span data-stu-id="8208f-105">General Concepts</span></span>  
 <span data-ttu-id="8208f-106">マージプロシージャには、ターゲットとソース管理の両方が含まれます。</span><span class="sxs-lookup"><span data-stu-id="8208f-106">Merging procedures involve both a target and a source control:</span></span>  
  
- <span data-ttu-id="8208f-107">ターゲットは、 <xref:System.Windows.Forms.MenuStrip> メニュー項目をマージするメインまたは MDI 親フォーム上のコントロールです。</span><span class="sxs-lookup"><span data-stu-id="8208f-107">The target is the <xref:System.Windows.Forms.MenuStrip> control on the main or MDI parent form into which you are merging menu items.</span></span>  
  
- <span data-ttu-id="8208f-108">ソースは、[ <xref:System.Windows.Forms.MenuStrip> ターゲット] メニューにマージするメニュー項目を含む MDI 子フォーム上のコントロールです。</span><span class="sxs-lookup"><span data-stu-id="8208f-108">The source is the <xref:System.Windows.Forms.MenuStrip> control on the MDI child form that contains the menu items you want to merge into the target menu.</span></span>  
  
 <span data-ttu-id="8208f-109">プロパティは、 <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> 現在の mdi 親フォームの mdi 子のタイトルを設定するドロップダウンリストを持つメニュー項目を識別します。</span><span class="sxs-lookup"><span data-stu-id="8208f-109">The <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> property identifies the menu item whose drop-down list you will populate with the titles of the current MDI parent form's MDI children.</span></span> <span data-ttu-id="8208f-110">たとえば、通常は [ **ウィンドウ** ] メニューで現在開いている MDI 子を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="8208f-110">For example, you typically list MDI children that are currently open on the **Window** menu.</span></span>  
  
 <span data-ttu-id="8208f-111">プロパティは、 <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> <xref:System.Windows.Forms.MenuStrip> MDI 子フォーム上のから取得されたメニュー項目を識別します。</span><span class="sxs-lookup"><span data-stu-id="8208f-111">The <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> property identifies which menu items come from a <xref:System.Windows.Forms.MenuStrip> on an MDI child form.</span></span>  
  
 <span data-ttu-id="8208f-112">メニュー項目は、手動または自動で結合できます。</span><span class="sxs-lookup"><span data-stu-id="8208f-112">You can merge menu items manually or automatically.</span></span> <span data-ttu-id="8208f-113">メニュー項目は両方の方法で同じ方法でマージされますが、このトピックで後述する「手動マージ」と「自動マージ」のセクションで説明したように、マージのアクティブ化は異なります。</span><span class="sxs-lookup"><span data-stu-id="8208f-113">The menu items merge in the same way for both methods, but the merge is activated differently, as discussed in the "Manual Merging" and "Automatic Merging" sections later in this topic.</span></span> <span data-ttu-id="8208f-114">手動マージと自動マージの両方で、マージアクションは、次のマージアクションに影響します。</span><span class="sxs-lookup"><span data-stu-id="8208f-114">In both manual and automatic merging, each merge action affects the next merge action.</span></span>  
  
 <span data-ttu-id="8208f-115"><xref:System.Windows.Forms.MenuStrip> マージ <xref:System.Windows.Forms.ToolStrip> は、の場合と同様に、メニュー項目を複製するのではなく、別のに移動し <xref:System.Windows.Forms.MainMenu> ます。</span><span class="sxs-lookup"><span data-stu-id="8208f-115"><xref:System.Windows.Forms.MenuStrip> merging moves menu items from one <xref:System.Windows.Forms.ToolStrip> to another rather than cloning them, as was the case with <xref:System.Windows.Forms.MainMenu>.</span></span>  
  
## <a name="mergeaction-values"></a><span data-ttu-id="8208f-116">MergeAction 値</span><span class="sxs-lookup"><span data-stu-id="8208f-116">MergeAction Values</span></span>  
 <span data-ttu-id="8208f-117">ソースのメニュー項目に対するマージ操作は、 <xref:System.Windows.Forms.MenuStrip> プロパティを使用して設定し <xref:System.Windows.Forms.MergeAction> ます。</span><span class="sxs-lookup"><span data-stu-id="8208f-117">You set the merge action on menu items in the source <xref:System.Windows.Forms.MenuStrip> using the <xref:System.Windows.Forms.MergeAction> property.</span></span>  
  
 <span data-ttu-id="8208f-118">次の表では、使用可能なマージアクションの意味と一般的な使用方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="8208f-118">The following table describes the meaning and typical use of the available merge actions.</span></span>  
  
|<span data-ttu-id="8208f-119">MergeAction 値</span><span class="sxs-lookup"><span data-stu-id="8208f-119">MergeAction Value</span></span>|<span data-ttu-id="8208f-120">説明</span><span class="sxs-lookup"><span data-stu-id="8208f-120">Description</span></span>|<span data-ttu-id="8208f-121">一般的な用途</span><span class="sxs-lookup"><span data-stu-id="8208f-121">Typical Use</span></span>|  
|-----------------------|-----------------|-----------------|  
|<xref:System.Windows.Forms.MergeAction.Append>|<span data-ttu-id="8208f-122">標準ソース項目をターゲット項目のコレクションの末尾に追加します。</span><span class="sxs-lookup"><span data-stu-id="8208f-122">(Default) Adds the source item to the end of the target item's collection.</span></span>|<span data-ttu-id="8208f-123">プログラムの一部がアクティブになったときにメニューの最後にメニュー項目を追加する。</span><span class="sxs-lookup"><span data-stu-id="8208f-123">Adding menu items to the end of the menu when some part of the program is activated.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Insert>|<span data-ttu-id="8208f-124">ソース項目に対して設定されたプロパティによって指定された場所で、ターゲット項目のコレクションにソース項目を追加し <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="8208f-124">Adds the source item to the target item's collection, in the location specified by the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> property set on the source item.</span></span>|<span data-ttu-id="8208f-125">プログラムの一部がアクティブになったときに、メニューの中央または先頭にメニュー項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="8208f-125">Adding menu items to the middle or the beginning of the menu when some part of the program is activated.</span></span><br /><br /> <span data-ttu-id="8208f-126">の値 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> が両方のメニュー項目で同じ場合は、逆順に追加されます。</span><span class="sxs-lookup"><span data-stu-id="8208f-126">If the value of <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> is the same for both menu items, they are added in reverse order.</span></span> <span data-ttu-id="8208f-127"><xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>元の順序を保持するために適切に設定します。</span><span class="sxs-lookup"><span data-stu-id="8208f-127">Set <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> appropriately to preserve the original order.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Replace>|<span data-ttu-id="8208f-128">一致するテキストを検索します。または、一致する文字列が見つからない場合は値を使用し、 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 一致するターゲットメニュー項目をソースメニュー項目に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="8208f-128">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then replaces the matching target menu item with the source menu item.</span></span>|<span data-ttu-id="8208f-129">ターゲットメニュー項目を、同じ名前のソースメニュー項目で置き換えます。</span><span class="sxs-lookup"><span data-stu-id="8208f-129">Replacing a target menu item with a source menu item of the same name that does something different.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.MatchOnly>|<span data-ttu-id="8208f-130">テキストの一致を検索します。または、テキストの一致が見つからない場合は値を使用し、 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> ソースからターゲットにすべてのドロップダウン項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="8208f-130">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then adds all the drop-down items from the source to the target.</span></span>|<span data-ttu-id="8208f-131">メニュー項目をサブメニューに挿入または追加したり、サブメニューからメニュー項目を削除したりするメニュー構造を構築します。</span><span class="sxs-lookup"><span data-stu-id="8208f-131">Building a menu structure that inserts or adds menu items into a submenu, or removes menu items from a submenu.</span></span> <span data-ttu-id="8208f-132">たとえば、MDI 子からメインの [ <xref:System.Windows.Forms.MenuStrip> **名前を付けて保存**] メニューにメニュー項目を追加できます。</span><span class="sxs-lookup"><span data-stu-id="8208f-132">For example, you can add a menu item from an MDI child to a main <xref:System.Windows.Forms.MenuStrip>**Save As** menu.</span></span><br /><br /> <span data-ttu-id="8208f-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> 操作を行わずに、メニュー構造内を移動することができます。</span><span class="sxs-lookup"><span data-stu-id="8208f-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> allows you to navigate through the menu structure without taking any action.</span></span> <span data-ttu-id="8208f-134">これにより、後続の項目を評価することができます。</span><span class="sxs-lookup"><span data-stu-id="8208f-134">It provides a way to evaluate the subsequent items.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Remove>|<span data-ttu-id="8208f-135">テキストの一致を検索します。または、 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> テキストの一致が見つからない場合は値を使用して、対象から項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="8208f-135">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then removes the item from the target.</span></span>|<span data-ttu-id="8208f-136">ターゲットからメニュー項目を削除 <xref:System.Windows.Forms.MenuStrip> しています。</span><span class="sxs-lookup"><span data-stu-id="8208f-136">Removing a menu item from the target <xref:System.Windows.Forms.MenuStrip>.</span></span>|  
  
## <a name="manual-merging"></a><span data-ttu-id="8208f-137">手動マージ</span><span class="sxs-lookup"><span data-stu-id="8208f-137">Manual Merging</span></span>  
 <span data-ttu-id="8208f-138"><xref:System.Windows.Forms.MenuStrip>自動マージに参加するのはコントロールのみです。</span><span class="sxs-lookup"><span data-stu-id="8208f-138">Only <xref:System.Windows.Forms.MenuStrip> controls participate in automatic merging.</span></span> <span data-ttu-id="8208f-139">コントロールやコントロールなど、他のコントロールの項目を組み合わせるには、 <xref:System.Windows.Forms.ToolStrip> <xref:System.Windows.Forms.StatusStrip> 必要に <xref:System.Windows.Forms.ToolStripManager.Merge%2A> <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> 応じてコード内のメソッドとメソッドを呼び出すことによって、それらを手動でマージする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8208f-139">To combine the items of other controls, such as <xref:System.Windows.Forms.ToolStrip> and <xref:System.Windows.Forms.StatusStrip> controls, you must merge them manually, by calling the <xref:System.Windows.Forms.ToolStripManager.Merge%2A> and <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> methods in your code as required.</span></span>  
  
## <a name="automatic-merging"></a><span data-ttu-id="8208f-140">自動マージ</span><span class="sxs-lookup"><span data-stu-id="8208f-140">Automatic Merging</span></span>  
 <span data-ttu-id="8208f-141">ソースフォームをアクティブ化することで、MDI アプリケーションの自動マージを使用できます。</span><span class="sxs-lookup"><span data-stu-id="8208f-141">You can use automatic merging for MDI applications by activating the source form.</span></span> <span data-ttu-id="8208f-142">MDI アプリケーションでを使用するには、 <xref:System.Windows.Forms.MenuStrip> プロパティをターゲットに設定して、 <xref:System.Windows.Forms.Form.MainMenuStrip%2A> <xref:System.Windows.Forms.MenuStrip> ソースで実行されるマージアクションが <xref:System.Windows.Forms.MenuStrip> ターゲットに反映されるようにし <xref:System.Windows.Forms.MenuStrip> ます。</span><span class="sxs-lookup"><span data-stu-id="8208f-142">To use a <xref:System.Windows.Forms.MenuStrip> in an MDI application, set the <xref:System.Windows.Forms.Form.MainMenuStrip%2A> property to the target <xref:System.Windows.Forms.MenuStrip> so that merging actions performed on the source <xref:System.Windows.Forms.MenuStrip> are reflected in the target <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
 <span data-ttu-id="8208f-143">自動マージをトリガーするには、 <xref:System.Windows.Forms.MenuStrip> MDI ソースでをアクティブにします。</span><span class="sxs-lookup"><span data-stu-id="8208f-143">You can trigger automatic merging by activating the <xref:System.Windows.Forms.MenuStrip> on the MDI source.</span></span> <span data-ttu-id="8208f-144">アクティブ化時に、ソース <xref:System.Windows.Forms.MenuStrip> が MDI ターゲットにマージされます。</span><span class="sxs-lookup"><span data-stu-id="8208f-144">Upon activation, the source <xref:System.Windows.Forms.MenuStrip> is merged into the MDI target.</span></span> <span data-ttu-id="8208f-145">新しいフォームがアクティブになると、最後のフォームでマージが元に戻され、新しいフォームでトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="8208f-145">When a new form becomes active, the merge is reverted on the last form and triggered on the new form.</span></span> <span data-ttu-id="8208f-146">この動作を制御するには、 <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> 各に対して必要に応じてプロパティを設定 <xref:System.Windows.Forms.ToolStripItem> し、 <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> それぞれのプロパティを設定し <xref:System.Windows.Forms.MenuStrip> ます。</span><span class="sxs-lookup"><span data-stu-id="8208f-146">You can control this behavior by setting the <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> property as needed on each <xref:System.Windows.Forms.ToolStripItem>, and by setting the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property on each <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8208f-147">関連項目</span><span class="sxs-lookup"><span data-stu-id="8208f-147">See also</span></span>

- <xref:System.Windows.Forms.ToolStripManager>
- <xref:System.Windows.Forms.MenuStrip>
- [<span data-ttu-id="8208f-148">MenuStrip コントロール</span><span class="sxs-lookup"><span data-stu-id="8208f-148">MenuStrip Control</span></span>](menustrip-control-windows-forms.md)
- [<span data-ttu-id="8208f-149">方法: MenuStrip を使用して MDI ウィンドウの一覧を作成する</span><span class="sxs-lookup"><span data-stu-id="8208f-149">How to: Create an MDI Window List with MenuStrip</span></span>](how-to-create-an-mdi-window-list-with-menustrip-windows-forms.md)
- [<span data-ttu-id="8208f-150">方法: MDI アプリケーションでメニューの自動マージを設定する</span><span class="sxs-lookup"><span data-stu-id="8208f-150">How to: Set Up Automatic Menu Merging for MDI Applications</span></span>](how-to-set-up-automatic-menu-merging-for-mdi-applications.md)
