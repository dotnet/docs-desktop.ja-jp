---
title: アプリケーション設定の概要
description: アプリケーションとユーザーの代わりに設定データを作成して保存する方法など、Windows フォームのアプリケーション設定機能について説明します。
ms.date: 03/30/2017
ms.topic: overview
f1_keywords:
- ApplicationsSettingsOverview
helpviewer_keywords:
- application settings [Windows Forms], about application settings
- dynamic properties
- user preferences [Windows Forms], tracking
ms.assetid: 0dd8bca5-a6bf-4ac4-8eec-5725d08b38dc
ms.openlocfilehash: fee810f2ed8dece1c804aba0003734470734760f
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96979846"
---
# <a name="application-settings-overview"></a><span data-ttu-id="d8f81-103">アプリケーション設定の概要</span><span class="sxs-lookup"><span data-stu-id="d8f81-103">Application Settings Overview</span></span>

<span data-ttu-id="d8f81-104">この記事では、アプリケーションとユーザーの代わりに設定データを作成して保存する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-104">This article discusses how to create and store settings data on behalf of your application and your users.</span></span>

 <span data-ttu-id="d8f81-105">Windows フォームのアプリケーション設定の機能により、カスタム アプリケーションと、クライアント コンピューター上のユーザー設定の作成、保存、および保守が簡単になります。</span><span class="sxs-lookup"><span data-stu-id="d8f81-105">The Application Settings feature of Windows Forms makes it easy to create, store, and maintain custom application and user preferences on the client computer.</span></span> <span data-ttu-id="d8f81-106">Windows フォーム アプリケーションの設定ではデータベースの接続文字列など、アプリケーションのデータだけでなく、ユーザー アプリケーションの設定などのユーザー固有のデータを格納することができます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-106">With Windows Forms application settings, you can store not only application data such as database connection strings, but also user-specific data, such as user application preferences.</span></span> <span data-ttu-id="d8f81-107">Visual Studio またはカスタムのマネージド コードを使用して、新しい設定の作成、ディスクからの読み取りまたは書き込み、フォームのプロパティへのバインド、および読み込みと保存の前の設定データの検証を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-107">Using Visual Studio or custom managed code, you can create new settings, read them from and write them to disk, bind them to properties on your forms, and validate settings data prior to loading and saving.</span></span>

 <span data-ttu-id="d8f81-108">アプリケーション設定を使用すると、開発者はカスタムコードをほとんど使用することなく、アプリケーションの状態を保存できます。また、以前のバージョンの .NET Framework では、動的プロパティに代わるものです。</span><span class="sxs-lookup"><span data-stu-id="d8f81-108">Application settings enables developers to save state in their application using very little custom code, and is a replacement for dynamic properties in previous versions of the .NET Framework.</span></span> <span data-ttu-id="d8f81-109">アプリケーション設定には、読み取り専用で、遅延バインディングであり、複数のカスタム プログラミングを必要とする動的プロパティに対する多くの機能強化が含まれます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-109">Application settings contains many improvements over dynamic properties, which are read-only, late-bound, and require more custom programming.</span></span> <span data-ttu-id="d8f81-110">動的プロパティクラスは .NET Framework 2.0 で保持されていますが、アプリケーション設定クラスを薄くラップするシェルクラスにすぎません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-110">The dynamic property classes have been retained in .NET Framework 2.0, but they are just shell classes that thinly wrap the application settings classes.</span></span>

## <a name="what-are-application-settings"></a><span data-ttu-id="d8f81-111">アプリケーション設定とは</span><span class="sxs-lookup"><span data-stu-id="d8f81-111">What Are Application Settings</span></span>

 <span data-ttu-id="d8f81-112">Windows フォームアプリケーションでは、多くの場合、アプリケーションの実行に不可欠なデータを必要としますが、アプリケーションのコードに直接含める必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-112">Your Windows Forms applications will often require data that's critical to running the application, but which you don't want to include directly in the application's code.</span></span> <span data-ttu-id="d8f81-113">アプリケーションで Web サービスまたはデータベースサーバーを使用する場合は、この情報を別のファイルに格納して、再コンパイルせずに後で変更できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-113">If your application uses a Web Service or a database server, you may want to store this information in a separate file, so that you can change it in the future without recompiling.</span></span> <span data-ttu-id="d8f81-114">同様に、アプリケーションは、現在のユーザーに固有の格納データを必要とすることがあります。</span><span class="sxs-lookup"><span data-stu-id="d8f81-114">Similarly, your applications may require storing data that is specific to the current user.</span></span> <span data-ttu-id="d8f81-115">たとえば、ほとんどのアプリケーションでは、アプリケーションの外観と動作をカスタマイズするユーザー設定があります。</span><span class="sxs-lookup"><span data-stu-id="d8f81-115">Most applications, for example, have user preferences that customize the application's appearance and behavior.</span></span>

 <span data-ttu-id="d8f81-116">アプリケーション設定は、クライアント コンピューターにアプリケーション スコープとユーザー スコープの両方の設定を保存する簡単な方法を提供することにより、両方のニーズに対応します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-116">Application settings addresses both needs by providing an easy way to store both application-scoped and user-scoped settings on the client computer.</span></span> <span data-ttu-id="d8f81-117">Visual Studio またはコード エディターを使用して、名前、データ型、およびスコープ (アプリケーションまたはユーザー) を指定して特定のプロパティの設定を定義します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-117">Using Visual Studio or a code editor, you define a setting for a given property by specifying its name, data type, and scope (application or user).</span></span> <span data-ttu-id="d8f81-118">使いやすさと読みやすさのために、関連する設定を名前付きのグループに配置することもできます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-118">You can even place related settings into named groups for easier use and readability.</span></span> <span data-ttu-id="d8f81-119">これらの設定は、定義された後も保持され、実行時に自動的にメモリに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-119">Once defined, these settings are persisted and read back into memory automatically at run time.</span></span> <span data-ttu-id="d8f81-120">プラグ可能なアーキテクチャにより永続化メカニズムを変更できますが、既定では、ローカル ファイル システムが使用されます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-120">A pluggable architecture enables the persistence mechanism to be changed, but by default, the local file system is used.</span></span>

 <span data-ttu-id="d8f81-121">アプリケーションの設定は、設定がアプリケーション スコープかユーザー スコープかに応じて、別の構成 (.config) ファイルに XML としてデータを保持することで機能します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-121">Application settings works by persisting data as XML to different configuration (.config) files, corresponding to whether the setting is application-scoped or user-scoped.</span></span> <span data-ttu-id="d8f81-122">ほとんどの場合は、アプリケーション スコープ設定は読み取り専用です。これは、アプリケーション スコープ設定がプログラム情報であり、通常は上書きする必要がないためです。</span><span class="sxs-lookup"><span data-stu-id="d8f81-122">In most cases, the application-scoped settings are read-only; because they are program information, you will typically not need to overwrite them.</span></span> <span data-ttu-id="d8f81-123">これに対し、ユーザー スコープ設定は、アプリケーションが部分信頼で実行されている場合でも、実行時に安全に読み書きできます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-123">By contrast, user-scoped settings can be read and written safely at run time, even if your application runs under partial trust.</span></span> <span data-ttu-id="d8f81-124">部分信頼の詳細については、「 [Security in Windows Forms Overview](../security-in-windows-forms-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d8f81-124">For more information about partial trust, see [Security in Windows Forms Overview](../security-in-windows-forms-overview.md).</span></span>

 <span data-ttu-id="d8f81-125">設定は、構成ファイルの XML フラグメントとして格納されます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-125">Settings are stored as XML fragments in configuration files.</span></span> <span data-ttu-id="d8f81-126">アプリケーション スコープ設定は `<applicationSettings>` 要素によって表され、通常は *app*.exe.config に配置されます。ここで、 *app* はメインの実行可能ファイルの名前です。</span><span class="sxs-lookup"><span data-stu-id="d8f81-126">Application-scoped settings are represented by the `<applicationSettings>` element, and generally are placed in *app*.exe.config, where *app* is the name of your main executable file.</span></span> <span data-ttu-id="d8f81-127">ユーザー スコープ設定は、 `<userSettings>` 要素によって表され、 *user*.config に配置されます。ここで、 *user* は、現在アプリケーションを実行しているユーザーのユーザー名です。</span><span class="sxs-lookup"><span data-stu-id="d8f81-127">User-scoped settings are represented by the `<userSettings>` element and are placed in *user*.config, where *user* is the user name of the person currently running the application.</span></span> <span data-ttu-id="d8f81-128">*app*.exe.config ファイルはアプリケーションと共に展開する必要があります。 *user*.config ファイルは、アプリケーションがそのユーザーの設定を初めて保存するときに、必要に応じて設定アーキテクチャが作成します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-128">You must deploy the *app*.exe.config file with your application; the settings architecture will create the *user*.config files on demand the first time the application saves settings for that user.</span></span> <span data-ttu-id="d8f81-129">また、 `<userSettings>` app *.exe.config 内で* ブロックを定義して、ユーザー スコープ設定の既定値を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-129">You can also define a `<userSettings>` block within *app*.exe.config to provide default values for user-scoped settings.</span></span>

 <span data-ttu-id="d8f81-130">カスタム コントロールでは、 <xref:System.Configuration.IPersistComponentSettings> メソッドを公開する <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> インターフェイスを実装することで、独自の設定を保存できます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-130">Custom controls can also save their own settings by implementing the <xref:System.Configuration.IPersistComponentSettings> interface, which exposes the <xref:System.Configuration.IPersistComponentSettings.SaveSettings%2A> method.</span></span> <span data-ttu-id="d8f81-131">Windows フォーム <xref:System.Windows.Forms.ToolStrip> コントロールは、このインターフェイスを実装して、アプリケーション セッション間でのツールバーとツールバー項目の位置を保存します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-131">The Windows Forms <xref:System.Windows.Forms.ToolStrip> control implements this interface to save the position of toolbars and toolbar items between application sessions.</span></span> <span data-ttu-id="d8f81-132">カスタム コントロールとアプリケーション設定の詳細については、「 [Application Settings for Custom Controls](application-settings-for-custom-controls.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d8f81-132">For more information about custom controls and application settings, see [Application Settings for Custom Controls](application-settings-for-custom-controls.md).</span></span>

## <a name="limitations-of-application-settings"></a><span data-ttu-id="d8f81-133">アプリケーションの設定の制限事項</span><span class="sxs-lookup"><span data-stu-id="d8f81-133">Limitations of Application Settings</span></span>

 <span data-ttu-id="d8f81-134">.NET Framework をホストするアンマネージアプリケーションでは、アプリケーション設定を使用できません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-134">You cannot use application settings in an unmanaged application that hosts the .NET Framework.</span></span> <span data-ttu-id="d8f81-135">Visual Studio アドイン、C++ for Microsoft Office、Internet Explorer のコントロール ホスト、Microsoft Outlook のアドインやプロジェクトなどの環境では、設定は機能しません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-135">Settings will not work in such environments as Visual Studio add-ins, C++ for Microsoft Office, control hosting in Internet Explorer, or Microsoft Outlook add-ins and projects.</span></span>

 <span data-ttu-id="d8f81-136">現在、Windows フォームの一部のプロパティをバインドできません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-136">You currently cannot bind to some properties in Windows Forms.</span></span> <span data-ttu-id="d8f81-137">最も注目に値する例は、 <xref:System.Windows.Forms.Form.ClientSize%2A> プロパティで、このプロパティへのバインドにより、実行時に予期しない動作が発生します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-137">The most notable example is the <xref:System.Windows.Forms.Form.ClientSize%2A> property, as binding to this property would cause unpredictable behavior at run time.</span></span> <span data-ttu-id="d8f81-138">これらの設定をプログラムで保存して読み込むことで、通常はこれらの問題を回避できます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-138">You can usually work around these issues by saving and loading these settings programmatically.</span></span>

 <span data-ttu-id="d8f81-139">アプリケーション設定には、情報を自動的に暗号化するための組み込みの機能がありません。</span><span class="sxs-lookup"><span data-stu-id="d8f81-139">Application settings has no built-in facility for encrypting information automatically.</span></span> <span data-ttu-id="d8f81-140">データベースのパスワードなどのセキュリティ関連の情報は、クリア テキストで保存しないでください。</span><span class="sxs-lookup"><span data-stu-id="d8f81-140">You should never store security-related information, such as database passwords, in clear text.</span></span> <span data-ttu-id="d8f81-141">このような機密情報を格納する場合、アプリケーション開発者に、機密情報の安全性を確保する責任があります。</span><span class="sxs-lookup"><span data-stu-id="d8f81-141">If you want to store such sensitive information, you as the application developer are responsible for making sure it is secure.</span></span> <span data-ttu-id="d8f81-142">接続文字列を格納する場合は、URL にパスワードをハード コーディングするのではなく、Windows 統合セキュリティを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d8f81-142">If you want to store connection strings, we recommend that you use Windows Integrated Security and not resort to hard-coding passwords into the URL.</span></span> <span data-ttu-id="d8f81-143">詳細については、「 [Code Access Security and ADO.NET](/dotnet/framework/data/adonet/code-access-security)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d8f81-143">For more information, see [Code Access Security and ADO.NET](/dotnet/framework/data/adonet/code-access-security).</span></span>

## <a name="getting-started-with-application-settings"></a><span data-ttu-id="d8f81-144">アプリケーション設定の概要</span><span class="sxs-lookup"><span data-stu-id="d8f81-144">Getting Started with Application Settings</span></span>

 <span data-ttu-id="d8f81-145">Visual Studio を使用している場合に、Windows フォーム デザイナーの **[プロパティ]** ウィンドウの **(ApplicationSettings)** プロパティを使用して設定を定義することができます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-145">If you use Visual Studio, you can define settings within the Windows Forms Designer using the **(ApplicationSettings)** property in the **Properties** window.</span></span> <span data-ttu-id="d8f81-146">この方法で設定を定義すると、Visual Studio は、各設定をクラスプロパティに関連付けるカスタムマネージラッパークラスを自動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-146">When you define settings this way, Visual Studio automatically creates a custom managed wrapper class that associates each setting with a class property.</span></span> <span data-ttu-id="d8f81-147">また、Visual Studio は、フォームが表示されるとコントロールの設定が自動的に復元され、フォームが閉じられると自動的に保存されるように、フォームまたはコントロールのプロパティへの設定のバインドも処理します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-147">Visual Studio also takes care of binding the setting to a property on a form or control so that the control's settings are restored automatically when its form is displayed, and saved automatically when the form is closed.</span></span>

 <span data-ttu-id="d8f81-148">設定のより詳細なコントロールが必要な場合は、独自のカスタムのアプリケーション設定のラッパー クラスを定義することができます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-148">If you want more detailed control over your settings, you can define your own custom applications settings wrapper class.</span></span> <span data-ttu-id="d8f81-149">これは、 <xref:System.Configuration.ApplicationSettingsBase>からクラスを派生させ、各設定に対応するプロパティを追加して、これらのプロパティに特別な属性を適用することで実現します。</span><span class="sxs-lookup"><span data-stu-id="d8f81-149">This is accomplished by deriving a class from <xref:System.Configuration.ApplicationSettingsBase>, adding a property that corresponds to each setting, and applying special attributes to these properties.</span></span> <span data-ttu-id="d8f81-150">ラッパー クラスを作成する方法については、「 [Application Settings Architecture](application-settings-architecture.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d8f81-150">For details about creating wrapper classes, see [Application Settings Architecture](application-settings-architecture.md).</span></span>

 <span data-ttu-id="d8f81-151">また、 <xref:System.Windows.Forms.Binding> クラスを使用して、フォームとコントロールのプロパティに設定をプログラムでバインドすることもできます。</span><span class="sxs-lookup"><span data-stu-id="d8f81-151">You can also use the <xref:System.Windows.Forms.Binding> class to bind settings programmatically to properties on forms and controls.</span></span>

## <a name="see-also"></a><span data-ttu-id="d8f81-152">関連項目</span><span class="sxs-lookup"><span data-stu-id="d8f81-152">See also</span></span>

- <xref:System.Configuration.ApplicationSettingsBase>
- <xref:System.Configuration.SettingsProvider>
- <xref:System.Configuration.LocalFileSettingsProvider>
- <xref:System.Configuration.IPersistComponentSettings>
- [<span data-ttu-id="d8f81-153">方法: アプリケーション設定を検証する</span><span class="sxs-lookup"><span data-stu-id="d8f81-153">How to: Validate Application Settings</span></span>](how-to-validate-application-settings.md)
- [<span data-ttu-id="d8f81-154">アプリケーションの設定の管理 (.NET)</span><span class="sxs-lookup"><span data-stu-id="d8f81-154">Managing Application Settings (.NET)</span></span>](/visualstudio/ide/managing-application-settings-dotnet)
- [<span data-ttu-id="d8f81-155">方法: 実行時に設定を C# で読み取る</span><span class="sxs-lookup"><span data-stu-id="d8f81-155">How To: Read Settings at Run Time With C#</span></span>](how-to-read-settings-at-run-time-with-csharp.md)
- [<span data-ttu-id="d8f81-156">アプリケーション設定とユーザー設定の使用</span><span class="sxs-lookup"><span data-stu-id="d8f81-156">Using Application Settings and User Settings</span></span>](using-application-settings-and-user-settings.md)
- [<span data-ttu-id="d8f81-157">アプリケーション設定アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="d8f81-157">Application Settings Architecture</span></span>](application-settings-architecture.md)
- [<span data-ttu-id="d8f81-158">カスタム コントロールのアプリケーション設定</span><span class="sxs-lookup"><span data-stu-id="d8f81-158">Application Settings for Custom Controls</span></span>](application-settings-for-custom-controls.md)
