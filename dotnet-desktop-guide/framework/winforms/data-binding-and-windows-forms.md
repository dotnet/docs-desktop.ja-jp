---
title: データ バインディング
description: 実行時に計算したり、ファイルから読み取ったり、Windows フォームの他のコントロールの値から派生したりする値の配列にバインドする方法について説明します。
ms.date: 03/30/2017
ms.topic: overview
helpviewer_keywords:
- master-details lists
- data [Windows Forms], data binding
- reports [Windows Forms], Windows Forms
- lookup tables [Windows Forms], data binding
- data [Windows Forms], complex data binding
- data binding [Windows Forms], Windows Forms
- data [Windows Forms], simple data binding
- Windows Forms controls, data binding
- data-bound controls [Windows Forms], Windows Forms
ms.assetid: 419aac5e-819b-4aad-88b0-73a2f8c0bd27
ms.openlocfilehash: 885d208c2aff3ec72ef6ac72d4ec5c7e132c83a5
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96983396"
---
# <a name="data-binding-and-windows-forms"></a><span data-ttu-id="e5173-103">データ連結と Windows フォーム</span><span class="sxs-lookup"><span data-stu-id="e5173-103">Data Binding and Windows Forms</span></span>
<span data-ttu-id="e5173-104">Windows フォームでは、従来のデータ ソースだけでなく、データを含むほぼすべての構造にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-104">In Windows Forms, you can bind to not just traditional data sources, but also to almost any structure that contains data.</span></span> <span data-ttu-id="e5173-105">実行時に計算する値、ファイルから読み取る値、または他のコントロールの値から派生する値の配列にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-105">You can bind to an array of values that you calculate at run time, read from a file, or derive from the values of other controls.</span></span>  
  
 <span data-ttu-id="e5173-106">さらに、任意のコントロールのプロパティをデータ ソースにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-106">In addition, you can bind any property of any control to the data source.</span></span> <span data-ttu-id="e5173-107">従来のデータ バインディングでは、通常は <xref:System.Windows.Forms.Control.Text%2A> コントロールの <xref:System.Windows.Forms.TextBox> プロパティなどの表示プロパティをデータ ソースにバインドします。</span><span class="sxs-lookup"><span data-stu-id="e5173-107">In traditional data binding, you typically bind the display property—for example, the <xref:System.Windows.Forms.Control.Text%2A> property of a <xref:System.Windows.Forms.TextBox> control—to the data source.</span></span> <span data-ttu-id="e5173-108">.NET Framework では、バインディングを使用して他のプロパティを設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-108">With the .NET Framework, you also have the option of setting other properties through binding as well.</span></span> <span data-ttu-id="e5173-109">バインディングを使用して、次のタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="e5173-109">You might use binding to perform the following tasks:</span></span>  
  
- <span data-ttu-id="e5173-110">イメージ コントロールのグラフィックの設定。</span><span class="sxs-lookup"><span data-stu-id="e5173-110">Setting the graphic of an image control.</span></span>  
  
- <span data-ttu-id="e5173-111">1 つ以上のコントロールの背景色の設定。</span><span class="sxs-lookup"><span data-stu-id="e5173-111">Setting the background color of one or more controls.</span></span>  
  
- <span data-ttu-id="e5173-112">コントロール サイズの設定。</span><span class="sxs-lookup"><span data-stu-id="e5173-112">Setting the size of controls.</span></span>  
  
 <span data-ttu-id="e5173-113">基本的には、データ バインディングは、フォーム上の任意のコントロールの実行時にアクセス可能なプロパティを自動的に設定する方法です。</span><span class="sxs-lookup"><span data-stu-id="e5173-113">Essentially, data binding is an automatic way of setting any run-time accessible property of any control on a form.</span></span>  
  
## <a name="types-of-data-binding"></a><span data-ttu-id="e5173-114">データ バインディングの種類</span><span class="sxs-lookup"><span data-stu-id="e5173-114">Types of Data Binding</span></span>  
 <span data-ttu-id="e5173-115">Windows フォームでは、単純バインディングと複合バインディングの 2 種類のデータ バインディングを利用できます。</span><span class="sxs-lookup"><span data-stu-id="e5173-115">Windows Forms can take advantage of two types of data binding: simple binding and complex binding.</span></span> <span data-ttu-id="e5173-116">それぞれに異なる利点があります。</span><span class="sxs-lookup"><span data-stu-id="e5173-116">Each offers different advantages.</span></span>  
  
|<span data-ttu-id="e5173-117">データ バインディングの種類</span><span class="sxs-lookup"><span data-stu-id="e5173-117">Type of data binding</span></span>|<span data-ttu-id="e5173-118">説明</span><span class="sxs-lookup"><span data-stu-id="e5173-118">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="e5173-119">単純データ バインディング</span><span class="sxs-lookup"><span data-stu-id="e5173-119">Simple data binding</span></span>|<span data-ttu-id="e5173-120">データセット テーブル内の列の値など、1 つのデータ要素にバインドするコントロールの機能。</span><span class="sxs-lookup"><span data-stu-id="e5173-120">The ability of a control to bind to a single data element, such as a value in a column in a dataset table.</span></span> <span data-ttu-id="e5173-121">これは、<xref:System.Windows.Forms.TextBox> コントロールや <xref:System.Windows.Forms.Label> コントロールなどのコントロールで一般的に使用される種類のバインディングです。これらのコントロールでは通常、1 つの値のみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e5173-121">This is the type of binding typical for controls such as a <xref:System.Windows.Forms.TextBox> control or <xref:System.Windows.Forms.Label> control, which are controls that typically only displays a single value.</span></span> <span data-ttu-id="e5173-122">実際には、コントロールのどのプロパティもデータベース内のフィールドにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-122">In fact, any property on a control can be bound to a field in a database.</span></span> <span data-ttu-id="e5173-123">この機能は Visual Studio で幅広くサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e5173-123">There is extensive support for this feature in Visual Studio.</span></span><br /><br /> <span data-ttu-id="e5173-124">詳細については、次を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e5173-124">For more information, see:</span></span><br /><br /> <span data-ttu-id="e5173-125">-   [データバインディングに関連するインターフェイス](interfaces-related-to-data-binding.md)</span><span class="sxs-lookup"><span data-stu-id="e5173-125">-   [Interfaces Related to Data Binding](interfaces-related-to-data-binding.md)</span></span><br /><span data-ttu-id="e5173-126">-   [方法: Windows フォーム内のデータを移動する](how-to-navigate-data-in-windows-forms.md)</span><span class="sxs-lookup"><span data-stu-id="e5173-126">-   [How to: Navigate Data in Windows Forms](how-to-navigate-data-in-windows-forms.md)</span></span><br /><span data-ttu-id="e5173-127">-   [方法: Windows フォームに Simple-Bound コントロールを作成する](how-to-create-a-simple-bound-control-on-a-windows-form.md)</span><span class="sxs-lookup"><span data-stu-id="e5173-127">-   [How to: Create a Simple-Bound Control on a Windows Form](how-to-create-a-simple-bound-control-on-a-windows-form.md)</span></span>|  
|<span data-ttu-id="e5173-128">複合データ バインディング</span><span class="sxs-lookup"><span data-stu-id="e5173-128">Complex data binding</span></span>|<span data-ttu-id="e5173-129">複数のデータ要素、一般的にはデータベース内の複数のレコードにバインドするコントロールの機能。</span><span class="sxs-lookup"><span data-stu-id="e5173-129">The ability of a control to bind to more than one data element, typically more than one record in a database.</span></span> <span data-ttu-id="e5173-130">複合バインディングは、リストベース バインディングとも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="e5173-130">Complex binding is also called list-based binding.</span></span> <span data-ttu-id="e5173-131">複合バインディングをサポートするコントロールの例には、<xref:System.Windows.Forms.DataGridView>、<xref:System.Windows.Forms.ListBox>、および <xref:System.Windows.Forms.ComboBox> の各コントロールがあります。</span><span class="sxs-lookup"><span data-stu-id="e5173-131">Examples of controls that support complex binding are the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.ListBox>, and <xref:System.Windows.Forms.ComboBox> controls.</span></span> <span data-ttu-id="e5173-132">複合データバインディングの例については、「 [方法: Windows フォーム ComboBox または ListBox コントロールをデータにバインド](./controls/how-to-bind-a-windows-forms-combobox-or-listbox-control-to-data.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e5173-132">For an example of complex data binding, see [How to: Bind a Windows Forms ComboBox or ListBox Control to Data](./controls/how-to-bind-a-windows-forms-combobox-or-listbox-control-to-data.md).</span></span>|  
  
## <a name="bindingsource-component"></a><span data-ttu-id="e5173-133">BindingSource コンポーネント</span><span class="sxs-lookup"><span data-stu-id="e5173-133">BindingSource Component</span></span>  
 <span data-ttu-id="e5173-134">データ バインディングを単純化するために、Windows フォームでは、データ ソースを <xref:System.Windows.Forms.BindingSource> コンポーネントにバインドしてから、コントロールを <xref:System.Windows.Forms.BindingSource> にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-134">To simplify data binding, Windows Forms enables you to bind a data source to the <xref:System.Windows.Forms.BindingSource> component and then bind controls to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="e5173-135"><xref:System.Windows.Forms.BindingSource> は、単純バインディングまたは複合バインディングのシナリオで使用できます。</span><span class="sxs-lookup"><span data-stu-id="e5173-135">You can use the <xref:System.Windows.Forms.BindingSource> in simple or complex binding scenarios.</span></span> <span data-ttu-id="e5173-136">いずれの場合も、<xref:System.Windows.Forms.BindingSource> はデータ ソースとバインドされたコントロールの間の媒介として機能し、変更通知、通貨管理などのサービスを提供します。</span><span class="sxs-lookup"><span data-stu-id="e5173-136">In either case, the <xref:System.Windows.Forms.BindingSource> acts as an intermediary between the data source and bound controls providing change notification currency management and other services.</span></span>  
  
## <a name="common-scenarios-that-employ-data-binding"></a><span data-ttu-id="e5173-137">データ バインディングを使用する一般的なシナリオ</span><span class="sxs-lookup"><span data-stu-id="e5173-137">Common Scenarios That Employ Data Binding</span></span>  
 <span data-ttu-id="e5173-138">ほぼすべての商用アプリケーションで、通常はデータ バインディングによってある種類のデータ ソースから別の種類のデータ ソースに読み取られた情報を使用します。</span><span class="sxs-lookup"><span data-stu-id="e5173-138">Nearly every commercial application uses information read from data sources of one type or another, usually through data binding.</span></span> <span data-ttu-id="e5173-139">次のリストに、データの表示および操作の方法としてデータ バインディングを使用する最も一般的なシナリオをいくつか示します。</span><span class="sxs-lookup"><span data-stu-id="e5173-139">The following list shows a few of the most common scenarios that utilize data binding as the method of data presentation and manipulation.</span></span>  
  
|<span data-ttu-id="e5173-140">シナリオ</span><span class="sxs-lookup"><span data-stu-id="e5173-140">Scenario</span></span>|<span data-ttu-id="e5173-141">説明</span><span class="sxs-lookup"><span data-stu-id="e5173-141">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="e5173-142">レポート</span><span class="sxs-lookup"><span data-stu-id="e5173-142">Reporting</span></span>|<span data-ttu-id="e5173-143">レポートは、印刷された文書でデータを表示および集計する柔軟な方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="e5173-143">Reports provide a flexible way for you to display and summarize your data in a printed document.</span></span> <span data-ttu-id="e5173-144">データ ソースの選択したコンテンツを画面またはプリンターに出力するレポートを作成することは、非常に一般的に行われます。</span><span class="sxs-lookup"><span data-stu-id="e5173-144">It is very common to create a report that prints selected contents of a data source either to the screen or to a printer.</span></span> <span data-ttu-id="e5173-145">一般的なレポートには、リスト、請求書、および概要などがあります。</span><span class="sxs-lookup"><span data-stu-id="e5173-145">Common reports include lists, invoices, and summaries.</span></span> <span data-ttu-id="e5173-146">通常、項目はリストの列として並べられ、サブ項目が各リスト項目に分類されますが、データに最も適したレイアウトをユーザーが選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e5173-146">Items are usually formatted into columns of lists, with sub-items organized under each list item, but you should choose the layout that best suits the data.</span></span>|  
|<span data-ttu-id="e5173-147">データ エントリ</span><span class="sxs-lookup"><span data-stu-id="e5173-147">Data entry</span></span>|<span data-ttu-id="e5173-148">大量の関連データを入力したり、ユーザーに情報の入力を求めたりする場合は、データ エントリ フォームを使用する方法が一般的です。</span><span class="sxs-lookup"><span data-stu-id="e5173-148">A common way to enter large amounts of related data or to prompt users for information is through a data entry form.</span></span> <span data-ttu-id="e5173-149">ユーザーは、テキスト ボックス、オプション ボタン、ドロップダウン リスト、およびチェック ボックスを使用して、情報を入力したり、オプションを選択したりできます。</span><span class="sxs-lookup"><span data-stu-id="e5173-149">Users can enter information or select choices using text boxes, option buttons, drop-down lists, and check boxes.</span></span> <span data-ttu-id="e5173-150">情報は送信され、入力された情報に基づく構造を持つデータベースに格納されます。</span><span class="sxs-lookup"><span data-stu-id="e5173-150">Information is then submitted and stored in a database, whose structure is based on the information entered.</span></span>|  
|<span data-ttu-id="e5173-151">マスター/詳細リレーションシップ</span><span class="sxs-lookup"><span data-stu-id="e5173-151">Master/detail relationship</span></span>|<span data-ttu-id="e5173-152">マスター/詳細アプリケーションは、関連データを表現するための形式の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="e5173-152">A master/detail application is one format for looking at related data.</span></span> <span data-ttu-id="e5173-153">具体的には、2 つのデータ テーブルと、それらを結合する関係があります。典型的なビジネスの例では、"顧客" テーブルと "注文" テーブルがあり、それらの間には、顧客とそれに対応する注文を結合する関係があります。</span><span class="sxs-lookup"><span data-stu-id="e5173-153">Specifically, there are two tables of data with a relation connecting them—in the classic business example, a "Customers" table and an "Orders" table with a relationship between them linking customers and their respective orders.</span></span> <span data-ttu-id="e5173-154">2つの Windows フォームコントロールを持つマスター/詳細アプリケーションの作成の詳細につい <xref:System.Windows.Forms.DataGridView> ては、「[方法: 2 つの Windows フォーム DataGridView コントロールを使用してマスター/詳細フォームを作成](./controls/create-a-master-detail-form-using-two-datagridviews.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e5173-154">For more information about creating a master/detail application with two Windows Forms <xref:System.Windows.Forms.DataGridView> controls, see [How to: Create a Master/Detail Form Using Two Windows Forms DataGridView Controls](./controls/create-a-master-detail-form-using-two-datagridviews.md)</span></span>|  
|<span data-ttu-id="e5173-155">参照テーブル</span><span class="sxs-lookup"><span data-stu-id="e5173-155">Lookup Table</span></span>|<span data-ttu-id="e5173-156">別の一般的なデータ表示/操作シナリオに、テーブル ルックアップがあります。</span><span class="sxs-lookup"><span data-stu-id="e5173-156">Another common data presentation/manipulation scenario is the table lookup.</span></span> <span data-ttu-id="e5173-157">多くの場合、より大きなデータ表示の一部として、<xref:System.Windows.Forms.ComboBox> コントロールを使用してデータを表示および操作します。</span><span class="sxs-lookup"><span data-stu-id="e5173-157">Often, as part of a larger data display, a <xref:System.Windows.Forms.ComboBox> control is used to display and manipulate data.</span></span> <span data-ttu-id="e5173-158">重要な点は、<xref:System.Windows.Forms.ComboBox> コントロールで表示されるデータは、データベースに書き込まれるデータとは異なることです。</span><span class="sxs-lookup"><span data-stu-id="e5173-158">The key is that the data displayed in the <xref:System.Windows.Forms.ComboBox> control is different than the data written to the database.</span></span> <span data-ttu-id="e5173-159">たとえば、食料品店から入手できる項目を表示する <xref:System.Windows.Forms.ComboBox> コントロールがあり、製品の名前 (パン、牛乳、卵) を表示するとします。</span><span class="sxs-lookup"><span data-stu-id="e5173-159">For example, if you have a <xref:System.Windows.Forms.ComboBox> control displaying the items available from a grocery store, you would probably like to see the names of the products (bread, milk, eggs).</span></span> <span data-ttu-id="e5173-160">しかし、データベース内での情報の取得を容易にしたり、データベースを正規化したりするには、ある注文の特定の項目に関する情報を項目番号 (#501、#603 など) で格納する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="e5173-160">However, to ease information retrieval within the database and for database normalization, you would probably store the information for the specific items of a given order as item numbers (#501, #603, and so on).</span></span> <span data-ttu-id="e5173-161">そのため、フォームの <xref:System.Windows.Forms.ComboBox> コントロールにある食料品項目の "わかりやすい名前" と、注文に表示される該当する項目番号との間には暗黙的なつながりがあります。</span><span class="sxs-lookup"><span data-stu-id="e5173-161">Thus, there is an implicit connection between the "friendly name" of the grocery item in the <xref:System.Windows.Forms.ComboBox> control on your form and the related item number that is present in an order.</span></span> <span data-ttu-id="e5173-162">これがテーブル ルックアップの本質です。</span><span class="sxs-lookup"><span data-stu-id="e5173-162">This is the essence of a table lookup.</span></span> <span data-ttu-id="e5173-163">詳細については、「 [方法: Windows フォーム BindingSource コンポーネントを使用してルックアップテーブルを作成](./controls/how-to-create-a-lookup-table-with-the-windows-forms-bindingsource-component.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e5173-163">For more information, see [How to: Create a Lookup Table with the Windows Forms BindingSource Component](./controls/how-to-create-a-lookup-table-with-the-windows-forms-bindingsource-component.md).</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e5173-164">関連項目</span><span class="sxs-lookup"><span data-stu-id="e5173-164">See also</span></span>

- <xref:System.Windows.Forms.Binding>
- [<span data-ttu-id="e5173-165">Windows フォームでのデータ バインディング</span><span class="sxs-lookup"><span data-stu-id="e5173-165">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
- [<span data-ttu-id="e5173-166">方法: データ ソースに Windows フォーム DataGrid コントロールをバインドする</span><span class="sxs-lookup"><span data-stu-id="e5173-166">How to: Bind the Windows Forms DataGrid Control to a Data Source</span></span>](./controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)
- [<span data-ttu-id="e5173-167">BindingSource コンポーネント</span><span class="sxs-lookup"><span data-stu-id="e5173-167">BindingSource Component</span></span>](./controls/bindingsource-component.md)
