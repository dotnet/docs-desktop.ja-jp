---
title: コントロールのフォーカスのスタイルと FocusVisualStyle
ms.date: 03/30/2017
helpviewer_keywords:
- keyboard focus [WPF]
- focus [WPF], visual styling
- styles [WPF], focus visual style
ms.assetid: 786ac576-011b-4d72-913b-558deccb9b35
ms.openlocfilehash: 3d038f0e1687efb0c2516602e8d5cbf24a60b36c
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96984487"
---
# <a name="styling-for-focus-in-controls-and-focusvisualstyle"></a><span data-ttu-id="c716c-102">コントロールのフォーカスのスタイルと FocusVisualStyle</span><span class="sxs-lookup"><span data-stu-id="c716c-102">Styling for Focus in Controls, and FocusVisualStyle</span></span>
[!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="c716c-103">では、キーボード フォーカスを受け取ったときにコントロールの外観を変更するためのメカニズムが、並列的に 2 つ用意されています。</span><span class="sxs-lookup"><span data-stu-id="c716c-103">provides two parallel mechanisms for changing the visual appearance of a control when it receives keyboard focus.</span></span> <span data-ttu-id="c716c-104">1 つ目のメカニズムは、コントロールに適用されるスタイルやテンプレート内で、<xref:System.Windows.UIElement.IsKeyboardFocused%2A> などのプロパティに対するプロパティ セッターを使用する方法です。</span><span class="sxs-lookup"><span data-stu-id="c716c-104">The first mechanism is to use property setters for properties such as <xref:System.Windows.UIElement.IsKeyboardFocused%2A> within the style or template that is applied to the control.</span></span> <span data-ttu-id="c716c-105">2 つ目のメカニズムは、<xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> プロパティの値として個別のスタイルを指定する方法です。"フォーカス表示スタイル" を使用すると、コントロールやその他の UI 要素のビジュアル ツリーを置き換えて変更するのではなく、コントロール上に描画する装飾用の独立したビジュアル ツリーを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="c716c-105">The second mechanism is to provide a separate style as the value of the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> property; the "focus visual style" creates a separate visual tree for an adorner that draws on top of the control, rather than changing the visual tree of the control or other UI element by replacing it.</span></span> <span data-ttu-id="c716c-106">このトピックでは、これらの各メカニズムがどのような場合に適しているかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="c716c-106">This topic discusses the scenarios where each of these mechanisms is appropriate.</span></span>  

<a name="Purpose"></a>
## <a name="the-purpose-of-focus-visual-style"></a><span data-ttu-id="c716c-107">フォーカス表示スタイルの目的</span><span class="sxs-lookup"><span data-stu-id="c716c-107">The Purpose of Focus Visual Style</span></span>  
 <span data-ttu-id="c716c-108">フォーカス表示スタイルは、UI 要素へのキーボード ナビゲーションに基づいてビジュアルなユーザー フィードバックを表示するための、共通の "オブジェクト モデル" を提供する機能です。</span><span class="sxs-lookup"><span data-stu-id="c716c-108">The focus visual style feature provides a common "object model" for introducing visual user feedback based on keyboard navigation to any UI element.</span></span> <span data-ttu-id="c716c-109">これは、コントロールに新しいテンプレートを適用したり、特定のテンプレート構成を把握したりしなくても利用できます。</span><span class="sxs-lookup"><span data-stu-id="c716c-109">This is possible without applying a new template to the control, or knowing the specific template composition.</span></span>  
  
 <span data-ttu-id="c716c-110">ただし、フォーカス表示スタイル機能はコントロール テンプレートを把握せずに動作するので、フォーカス表示スタイルを使用したコントロールに表示できるビジュアル フィードバックは、必然的に限定されます。</span><span class="sxs-lookup"><span data-stu-id="c716c-110">However, precisely because the focus visual style feature works without knowing the control templates, the visual feedback that can be displayed for a control using a focus visual style is necessarily limited.</span></span> <span data-ttu-id="c716c-111">この機能によって実際に行われることは、テンプレートを使用したコントロールのレンダリングによって作成されたビジュアル ツリーの上に、別のビジュアル ツリー (装飾) を重ね合わせるという処理です。</span><span class="sxs-lookup"><span data-stu-id="c716c-111">What the feature actually does is to overlay a different visual tree (an adorner) on top of the visual tree as created by a control's rendering through its template.</span></span> <span data-ttu-id="c716c-112">この個別のビジュアル ツリーは、<xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> プロパティに従ったスタイルを使用して定義します。</span><span class="sxs-lookup"><span data-stu-id="c716c-112">You define this separate visual tree using a style that fills the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> property.</span></span>  
  
<a name="Default"></a>
## <a name="default-focus-visual-style-behavior"></a><span data-ttu-id="c716c-113">既定のフォーカス表示スタイル動作</span><span class="sxs-lookup"><span data-stu-id="c716c-113">Default Focus Visual Style Behavior</span></span>  
 <span data-ttu-id="c716c-114">フォーカス表示スタイルは、フォーカス アクションがキーボードによって開始された場合にのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="c716c-114">Focus visual styles act only when the focus action was initiated by the keyboard.</span></span> <span data-ttu-id="c716c-115">マウス操作やプログラムによるフォーカス変更の場合、フォーカス表示スタイルのモードは無効になります。</span><span class="sxs-lookup"><span data-stu-id="c716c-115">Any mouse action or programmatic focus change disables the mode for focus visual styles.</span></span> <span data-ttu-id="c716c-116">各フォーカス モードの違いについて詳しくは、「[フォーカスの概要](focus-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c716c-116">For more information about the distinctions between focus modes, see [Focus Overview](focus-overview.md).</span></span>  
  
 <span data-ttu-id="c716c-117">コントロールのテーマには、既定のフォーカス表示スタイル動作があり、その動作が、そのテーマ内のすべてのコントロールのフォーカス表示スタイルになります。</span><span class="sxs-lookup"><span data-stu-id="c716c-117">The themes for controls include a default focus visual style behavior that becomes the focus visual style for all controls in the theme.</span></span> <span data-ttu-id="c716c-118">このテーマ スタイルは、静的キー <xref:System.Windows.SystemParameters.FocusVisualStyleKey%2A> の値によって識別されます。</span><span class="sxs-lookup"><span data-stu-id="c716c-118">This theme style is identified by the value of the static key <xref:System.Windows.SystemParameters.FocusVisualStyleKey%2A>.</span></span> <span data-ttu-id="c716c-119">アプリケーション レベルで独自のフォーカス表示スタイルを宣言すると、この既定のスタイル動作が置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="c716c-119">When you declare your own focus visual style at the application level, you replace this default style behavior from the themes.</span></span> <span data-ttu-id="c716c-120">テーマ全体を定義する場合は、その同じキーを使用して、テーマ全体の既定動作のスタイルを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-120">Alternatively, if you define the entire theme, then you should use this same key to define the style for the default behavior for your entire theme.</span></span>  
  
 <span data-ttu-id="c716c-121">テーマ内では、通常、既定のフォーカス表示スタイルは非常にシンプルなものです。</span><span class="sxs-lookup"><span data-stu-id="c716c-121">In the themes, the default focus visual style is generally very simple.</span></span> <span data-ttu-id="c716c-122">大まかに表すと、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="c716c-122">The following is a rough approximation:</span></span>  
  
```xaml  
<Style x:Key="{x:Static SystemParameters.FocusVisualStyleKey}">  
  <Setter Property="Control.Template">  
    <Setter.Value>  
      <ControlTemplate>  
        <Rectangle StrokeThickness="1"  
          Stroke="Black"  
          StrokeDashArray="1 2"  
          SnapsToDevicePixels="true"/>  
      </ControlTemplate>  
    </Setter.Value>  
  </Setter>  
</Style>  
```  
  
<a name="When"></a>
## <a name="when-to-use-focus-visual-styles"></a><span data-ttu-id="c716c-123">フォーカス表示スタイルをいつ使用するか</span><span class="sxs-lookup"><span data-stu-id="c716c-123">When to Use Focus Visual Styles</span></span>  
 <span data-ttu-id="c716c-124">基本的な考え方として、コントロールに適用されるフォーカス表示スタイルの外観は、各コントロール間で一貫している必要があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-124">Conceptually, the appearance of focus visual styles applied to controls should be coherent from control to control.</span></span> <span data-ttu-id="c716c-125">一貫性を維持するための 1 つの方法として、フォーカス表示スタイルを変更するのは、テーマ全体を構成する場合だけに限定するという方法があります。その場合、テーマ内で定義されている各コントロールに、まったく同じフォーカス表示スタイルを使用することもできますし、見た目の共通性を維持しながら、コントロールごとにスタイルのバリエーションを持たせることもできます。</span><span class="sxs-lookup"><span data-stu-id="c716c-125">One way to ensure coherence is to change the focus visual style only if you are composing an entire theme, where each control that is defined in the theme gets either the very same focus visual style, or some variation of a style that is visually related from control to control.</span></span> <span data-ttu-id="c716c-126">また、ページや UI の要素のうち、キーボードでのフォーカス取得が可能なすべて要素について、同じスタイル (または類似のスタイル) を使ってスタイルを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="c716c-126">Alternatively, you might use the same style (or similar styles) to style every keyboard-focusable element on a page or in a UI.</span></span>  
  
 <span data-ttu-id="c716c-127">テーマに属していない個々のコントロール スタイルに対して <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> を設定することは、フォーカス表示スタイルの本来の用途ではありません。</span><span class="sxs-lookup"><span data-stu-id="c716c-127">Setting <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> on individual control styles that are not part of a theme is not the intended usage of focus visual styles.</span></span> <span data-ttu-id="c716c-128">表示動作がコントロール間で一貫していないと、キーボードのフォーカスに関してユーザーが混乱する可能性があるからです。</span><span class="sxs-lookup"><span data-stu-id="c716c-128">This is because an inconsistent visual behavior between controls can lead to a confusing user experience regarding keyboard focus.</span></span> <span data-ttu-id="c716c-129">キーボード フォーカスに関する動作として、テーマ全体での一貫性から外れたものを特定のコントロールに意図的に指定したい場合は、個別の入力状態プロパティ (<xref:System.Windows.UIElement.IsFocused%2A> や <xref:System.Windows.UIElement.IsKeyboardFocused%2A> など) に対応したスタイルのトリガーを使用する方がアプローチとして適しています。</span><span class="sxs-lookup"><span data-stu-id="c716c-129">If you are intending control-specific behaviors for keyboard focus that are deliberately not coherent across a theme, a much better approach is to use triggers in styles for individual input state properties, such as <xref:System.Windows.UIElement.IsFocused%2A> or <xref:System.Windows.UIElement.IsKeyboardFocused%2A>.</span></span>  
  
 <span data-ttu-id="c716c-130">フォーカス表示スタイルは、キーボード フォーカス専用です。</span><span class="sxs-lookup"><span data-stu-id="c716c-130">Focus visual styles act exclusively for keyboard focus.</span></span> <span data-ttu-id="c716c-131">そのため、フォーカス表示スタイルはユーザー補助機能の一種と言えます。</span><span class="sxs-lookup"><span data-stu-id="c716c-131">As such, focus visual styles are a type of accessibility feature.</span></span> <span data-ttu-id="c716c-132">あらゆるタイプのフォーカス (マウス、キーボード、またはプログラム) を対象に UI を変更したい場合は、フォーカス表示スタイルを使用するのではなく、一般的なフォーカス プロパティ (<xref:System.Windows.UIElement.IsFocused%2A> や <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> など) の値によって動作するスタイルやテンプレートで、セッターやトリガーを使用するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="c716c-132">If you want UI changes for any type of focus, whether via mouse, keyboard, or programmatically, then you should not use focus visual styles, and should instead use setters and triggers in styles or templates that are working from the value of general focus properties such as <xref:System.Windows.UIElement.IsFocused%2A> or <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>.</span></span>  
  
<a name="How"></a>
## <a name="how-to-create-a-focus-visual-style"></a><span data-ttu-id="c716c-133">フォーカス表示スタイルの作成方法</span><span class="sxs-lookup"><span data-stu-id="c716c-133">How to Create a Focus Visual Style</span></span>  
 <span data-ttu-id="c716c-134">フォーカス表示スタイル用に作成するスタイルでは、常に <xref:System.Windows.Style.TargetType%2A> を <xref:System.Windows.Controls.Control> にします。</span><span class="sxs-lookup"><span data-stu-id="c716c-134">The style you create for a focus visual style should always have the <xref:System.Windows.Style.TargetType%2A> of <xref:System.Windows.Controls.Control>.</span></span> <span data-ttu-id="c716c-135">このスタイルは、主に <xref:System.Windows.Controls.ControlTemplate> で構成される必要があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-135">The style should consist mainly of a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="c716c-136">ターゲットの種類として、そのフォーカス表示スタイルが <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> に割り当てられている種類を指定することはしないでください。</span><span class="sxs-lookup"><span data-stu-id="c716c-136">You do not specify the target type to be the type where the focus visual style is assigned to the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>.</span></span>  
  
 <span data-ttu-id="c716c-137">ターゲットの種類は常に <xref:System.Windows.Controls.Control> となるので、すべてのコントロールに共通するプロパティを使用してスタイルを設定する必要があります (<xref:System.Windows.Controls.Control> クラスとその基本クラスのプロパティを使用します)。</span><span class="sxs-lookup"><span data-stu-id="c716c-137">Because the target type is always <xref:System.Windows.Controls.Control>, you must style by using properties that are common to all controls (using properties of the <xref:System.Windows.Controls.Control> class and its base classes).</span></span> <span data-ttu-id="c716c-138">テンプレートを作成する際には、UI 要素へのオーバーレイとして正しく機能すると共に、コントロールの機能領域が不明瞭にならないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-138">You should create a template that will properly function as an overlay to a UI element and that will not obscure functional areas of the control.</span></span> <span data-ttu-id="c716c-139">つまり、ビジュアル フィードバックがコントロールの余白の外側に表示されるようにするか、一時的な (または目立ち過ぎない) 効果として表示されるようにして、フォーカス表示スタイルが適用されたコントロールに対するヒット テストの邪魔にならないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-139">Generally, this means that the visual feedback should appear outside the control margins, or as temporary or unobtrusive effects that will not block the hit testing on the control where the focus visual style is applied.</span></span> <span data-ttu-id="c716c-140">テンプレートのバインドで使用できるプロパティのうち、オーバーレイ テンプレートのサイズや位置を決定するのに役立つものとしては、<xref:System.Windows.FrameworkElement.ActualHeight%2A>、<xref:System.Windows.FrameworkElement.ActualWidth%2A>、<xref:System.Windows.FrameworkElement.Margin%2A>、<xref:System.Windows.Controls.Control.Padding%2A> があります。</span><span class="sxs-lookup"><span data-stu-id="c716c-140">Properties that you can use in template binding that are useful for determining sizing and positioning of your overlay template include <xref:System.Windows.FrameworkElement.ActualHeight%2A>, <xref:System.Windows.FrameworkElement.ActualWidth%2A>, <xref:System.Windows.FrameworkElement.Margin%2A>, and <xref:System.Windows.Controls.Control.Padding%2A>.</span></span>  
  
<a name="Alternatives"></a>
## <a name="alternatives-to-using-a-focus-visual-style"></a><span data-ttu-id="c716c-141">フォーカス表示スタイルの代替手段</span><span class="sxs-lookup"><span data-stu-id="c716c-141">Alternatives to Using a Focus Visual Style</span></span>  
 <span data-ttu-id="c716c-142">1 つのコントロールだけにスタイルを設定する場合や、コントロール テンプレートをより細かく制御したい場合など、フォーカス表示スタイルを使用するのが適切でない場合でも、フォーカスの変化に応じて表示動作を作成できるプロパティは他にもたくさんあります。</span><span class="sxs-lookup"><span data-stu-id="c716c-142">For situations where using a focus visual style is not appropriate, either because you are only styling single controls or because you want greater control over the control template, there are many other accessible properties and techniques that can create visual behavior in response to changes in focus.</span></span>  
  
 <span data-ttu-id="c716c-143">トリガー、セッター、およびイベント セッターについては、「[スタイルとテンプレート](/dotnet/desktop-wpf/fundamentals/styles-templates-overview)」で詳しく説明しています。</span><span class="sxs-lookup"><span data-stu-id="c716c-143">Triggers, setters, and event setters are all discussed in detail in [Styling and Templating](/dotnet/desktop-wpf/fundamentals/styles-templates-overview).</span></span> <span data-ttu-id="c716c-144">ルーティング イベントの処理については、「[ルーティング イベントの概要](routed-events-overview.md)」で説明しています。</span><span class="sxs-lookup"><span data-stu-id="c716c-144">Routed event handling is discussed in [Routed Events Overview](routed-events-overview.md).</span></span>  
  
### <a name="iskeyboardfocused"></a><span data-ttu-id="c716c-145">IsKeyboardFocused</span><span class="sxs-lookup"><span data-stu-id="c716c-145">IsKeyboardFocused</span></span>  
 <span data-ttu-id="c716c-146">キーボード フォーカスに特化して対応したい場合は、<xref:System.Windows.UIElement.IsKeyboardFocused%2A> 依存関係プロパティをプロパティ <xref:System.Windows.Trigger> に使用することができます。</span><span class="sxs-lookup"><span data-stu-id="c716c-146">If you are specifically interested in keyboard focus, the <xref:System.Windows.UIElement.IsKeyboardFocused%2A> dependency property can be used for a property <xref:System.Windows.Trigger>.</span></span> <span data-ttu-id="c716c-147">1 つのコントロールだけを対象にする場合で、他のコントロールのキーボード フォーカス動作とは見た目が調和しない可能性がある場合は、スタイルまたはテンプレートでプロパティ トリガーを使用すると、キーボード フォーカス動作をより効果的に定義することができます。</span><span class="sxs-lookup"><span data-stu-id="c716c-147">A property trigger in either a style or template is a more appropriate technique for defining a keyboard focus behavior that is very specifically for a single control, and which might not visually match the keyboard focus behavior for other controls.</span></span>  
  
 <span data-ttu-id="c716c-148">これに似たもう 1 つの依存関係プロパティとして、<xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> も使用できます。これは、キーボード フォーカスが複合的なコントロール領域や機能領域内にあることを視覚的に示したい場合に適しています。</span><span class="sxs-lookup"><span data-stu-id="c716c-148">Another similar dependency property is <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>, which might be appropriate to use if you want to visually call out that keyboard focus is somewhere within compositing or within the functional area of the control.</span></span> <span data-ttu-id="c716c-149">たとえば、複数のコントロールをグループ化したパネルがある場合、<xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> トリガーを配置すれば、キーボード フォーカスがそのパネル内の個別の要素にまで絞られていない場合でも、そのパネルの表示が変わるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="c716c-149">For example, you might place an <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> trigger such that a panel that groups several controls appears differently, even though keyboard focus might more precisely be on an individual element within that panel.</span></span>  
  
 <span data-ttu-id="c716c-150">また、<xref:System.Windows.UIElement.GotKeyboardFocus> イベントと <xref:System.Windows.UIElement.LostKeyboardFocus> イベント (およびプレビュー版での同等機能) を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="c716c-150">You can also use the events <xref:System.Windows.UIElement.GotKeyboardFocus> and <xref:System.Windows.UIElement.LostKeyboardFocus> (as well as their Preview equivalents).</span></span> <span data-ttu-id="c716c-151">これらのイベントは、<xref:System.Windows.EventSetter> の基礎として使用できます。また、分離コード内のイベントのハンドラーを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="c716c-151">You can use these events as the basis for an <xref:System.Windows.EventSetter>, or you can write handlers for the events in code-behind.</span></span>  
  
### <a name="other-focus-properties"></a><span data-ttu-id="c716c-152">その他のフォーカス プロパティ</span><span class="sxs-lookup"><span data-stu-id="c716c-152">Other Focus Properties</span></span>  
 <span data-ttu-id="c716c-153">フォーカス変更のあらゆる原因に対応して表示動作を生成したい場合は、セッターやトリガーのベースとして <xref:System.Windows.UIElement.IsFocused%2A> 依存関係プロパティを使用するか、<xref:System.Windows.UIElement.GotFocus> または <xref:System.Windows.UIElement.LostFocus> イベントを <xref:System.Windows.EventSetter> に使用するようにしましょう。</span><span class="sxs-lookup"><span data-stu-id="c716c-153">If you want all possible causes of changing focus to produce a visual behavior, you should base a setter or trigger on the <xref:System.Windows.UIElement.IsFocused%2A> dependency property, or alternatively on the <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus> events used for an <xref:System.Windows.EventSetter>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c716c-154">関連項目</span><span class="sxs-lookup"><span data-stu-id="c716c-154">See also</span></span>

- <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>
- [<span data-ttu-id="c716c-155">スタイルとテンプレート</span><span class="sxs-lookup"><span data-stu-id="c716c-155">Styling and Templating</span></span>](/dotnet/desktop-wpf/fundamentals/styles-templates-overview)
- [<span data-ttu-id="c716c-156">フォーカスの概要</span><span class="sxs-lookup"><span data-stu-id="c716c-156">Focus Overview</span></span>](focus-overview.md)
- [<span data-ttu-id="c716c-157">入力の概要</span><span class="sxs-lookup"><span data-stu-id="c716c-157">Input Overview</span></span>](input-overview.md)
