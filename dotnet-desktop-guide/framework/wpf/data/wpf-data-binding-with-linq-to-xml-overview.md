---
title: LINQ to XML による WPF のデータ バインディング
ms.date: 10/22/2019
ms.topic: conceptual
ms.openlocfilehash: 093368c92d40f6b69c27002443a9e069c9f4bf3f
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96985784"
---
# <a name="overview-of-wpf-data-binding-with-linq-to-xml"></a><span data-ttu-id="ab8c7-102">LINQ to XML による WPF のデータ バインディングの概要</span><span class="sxs-lookup"><span data-stu-id="ab8c7-102">Overview of WPF data binding with LINQ to XML</span></span>

<span data-ttu-id="ab8c7-103">この記事では、<xref:System.Xml.Linq> 名前空間の動的データ バインド機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-103">This article introduces the dynamic data binding features in the <xref:System.Xml.Linq> namespace.</span></span> <span data-ttu-id="ab8c7-104">これらの機能は、Windows Presentation Foundation (WPF) アプリのユーザー インターフェイス (UI) 要素のデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-104">These features can be used as a data source for user interface (UI) elements in Windows Presentation Foundation (WPF) apps.</span></span> <span data-ttu-id="ab8c7-105">このシナリオは、<xref:System.Xml.Linq.XAttribute?displayProperty=fullName> および <xref:System.Xml.Linq.XElement?displayProperty=fullName> の特殊な *動的プロパティ* に依存しています。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-105">This scenario relies upon special *dynamic properties* of <xref:System.Xml.Linq.XAttribute?displayProperty=fullName> and <xref:System.Xml.Linq.XElement?displayProperty=fullName>.</span></span>

## <a name="xaml-and-linq-to-xml"></a><span data-ttu-id="ab8c7-106">XAML と LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ab8c7-106">XAML and LINQ to XML</span></span>

<span data-ttu-id="ab8c7-107">Extensible Application Markup Language (XAML) は、.NET のテクノロジをサポートするために Microsoft によって作成された XML 言語です。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-107">The Extensible Application Markup Language (XAML) is an XML dialect created by Microsoft to support .NET technologies.</span></span> <span data-ttu-id="ab8c7-108">XAML は、WPF ではユーザー インターフェイス要素やその関連機能 (イベントやデータ バインドなど) を表すために使用され、</span><span class="sxs-lookup"><span data-stu-id="ab8c7-108">It is used in WPF to represent user interface elements and related features, such as events and data binding.</span></span> <span data-ttu-id="ab8c7-109">Windows Workflow Foundation ではプログラム制御 (*ワークフロー*) などのプログラム構造を表すために使用されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-109">In Windows Workflow Foundation, XAML is used to represent program structure, such as program control (*workflows*).</span></span> <span data-ttu-id="ab8c7-110">XAML を使用すると、テクノロジの宣言型の側面を、プログラムのより個別的な動作を定義する、関連する手続き型のコードから分離することができます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-110">XAML enables the declarative aspects of a technology to be separated from the related procedural code that defines the more individualized behavior of a program.</span></span>

<span data-ttu-id="ab8c7-111">XAML と LINQ to XML の相互作用には、大きく分けて次の 2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-111">There are two broad ways that XAML and LINQ to XML can interact:</span></span>

- <span data-ttu-id="ab8c7-112">XAML ファイルは整形式の XML であるため、LINQ to XML などの XML テクノロジによるクエリや操作が可能です。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-112">Because XAML files are well-formed XML, they can be queried and manipulated through XML technologies such as LINQ to XML.</span></span>

- <span data-ttu-id="ab8c7-113">LINQ to XML のクエリはデータのソースを表すため、WPF UI 要素のデータ バインドのデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-113">Because LINQ to XML queries represent a source of data, these queries can be used as a data source for data binding for WPF UI elements.</span></span>

<span data-ttu-id="ab8c7-114">このドキュメントでは、2 番目のシナリオについて説明します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-114">This documentation describes the second scenario.</span></span>

## <a name="data-binding-in-the-windows-presentation-foundation"></a><span data-ttu-id="ab8c7-115">Windows Presentation Foundation でのデータ バインディング</span><span class="sxs-lookup"><span data-stu-id="ab8c7-115">Data binding in the Windows Presentation Foundation</span></span>

<span data-ttu-id="ab8c7-116">WPF のデータ バインドでは、UI 要素のプロパティをデータ ソースに関連付けることができます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-116">WPF data binding enables a UI element to associate one of its properties with a data source.</span></span> <span data-ttu-id="ab8c7-117">たとえば、ユーザー定義オブジェクトのパブリック プロパティの値をテキストとして表示する <xref:System.Windows.Controls.Label> はその簡単な例です。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-117">A simple example of this is a <xref:System.Windows.Controls.Label> whose text presents the value of a public property in a user-defined object.</span></span> <span data-ttu-id="ab8c7-118">WPF のデータ バインドは次のコンポーネントに依存しています。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-118">WPF data binding relies on the following components:</span></span>

|<span data-ttu-id="ab8c7-119">コンポーネント</span><span class="sxs-lookup"><span data-stu-id="ab8c7-119">Component</span></span>|<span data-ttu-id="ab8c7-120">説明</span><span class="sxs-lookup"><span data-stu-id="ab8c7-120">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="ab8c7-121">バインド ターゲット</span><span class="sxs-lookup"><span data-stu-id="ab8c7-121">Binding target</span></span>|<span data-ttu-id="ab8c7-122">データ ソースに関連付ける UI 要素。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-122">The UI element to be associated with the data source.</span></span> <span data-ttu-id="ab8c7-123">WPF のビジュアル要素は <xref:System.Windows.UIElement> クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-123">Visual elements in WPF are derived from the <xref:System.Windows.UIElement> class.</span></span>|
|<span data-ttu-id="ab8c7-124">対象になるプロパティ</span><span class="sxs-lookup"><span data-stu-id="ab8c7-124">Target property</span></span>|<span data-ttu-id="ab8c7-125">バインド ターゲットの *依存プロパティ*。データ バインディング ソースの値が反映されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-125">The *dependency property* of the binding target that reflects the value of the data-binding source.</span></span> <span data-ttu-id="ab8c7-126">依存プロパティは、<xref:System.Windows.DependencyObject> の派生元である <xref:System.Windows.UIElement> クラスによって直接サポートされます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-126">Dependency properties are directly supported by the <xref:System.Windows.DependencyObject> class, which <xref:System.Windows.UIElement> derives from.</span></span>|
|<span data-ttu-id="ab8c7-127">バインド ソース</span><span class="sxs-lookup"><span data-stu-id="ab8c7-127">Binding source</span></span>|<span data-ttu-id="ab8c7-128">表示のために UI 要素に渡される 1 つ以上の値のソース オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-128">The source object for one or more values that are supplied to the UI element for presentation.</span></span> <span data-ttu-id="ab8c7-129">WPF で自動的にサポートされるバインド ソースは、CLR オブジェクト、ADO.NET データ オブジェクト、XML データ (XPath または LINQ to XML のクエリからの XML データ)、および他の <xref:System.Windows.DependencyObject> です。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-129">WPF automatically supports the following types as binding sources: CLR objects, ADO.NET data objects, XML data (from XPath or LINQ to XML queries), or another <xref:System.Windows.DependencyObject>.</span></span>|
|<span data-ttu-id="ab8c7-130">ソース パス</span><span class="sxs-lookup"><span data-stu-id="ab8c7-130">Source path</span></span>|<span data-ttu-id="ab8c7-131">バインドされる値または値のセットに解決されるバインド ソースのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-131">The property of the binding source that resolves to the value or set of values that is to be bound.</span></span>|

<span data-ttu-id="ab8c7-132">依存プロパティは WPF 固有の概念であり、UI 要素の動的に計算されるプロパティを表します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-132">A dependency property is a concept specific to WPF that represent a dynamically computed property of a UI element.</span></span> <span data-ttu-id="ab8c7-133">たとえば、依存プロパティの既定値は多くの場合、親要素によって提供されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-133">For example, dependency properties often have default values or values that are provided by a parent element.</span></span> <span data-ttu-id="ab8c7-134">これらの特殊なプロパティは、<xref:System.Windows.DependencyProperty> クラスのインスタンスに基づいています (標準のプロパティはフィールドに基づいています)。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-134">These special properties are backed by instances of the <xref:System.Windows.DependencyProperty> class (and not fields as with standard properties).</span></span> <span data-ttu-id="ab8c7-135">依存関係プロパティの詳細については、「[依存関係プロパティの概要](../advanced/dependency-properties-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-135">For more information, see [Dependency Properties Overview](../advanced/dependency-properties-overview.md).</span></span>

### <a name="dynamic-data-binding-in-wpf"></a><span data-ttu-id="ab8c7-136">WPF での動的データ バインディング</span><span class="sxs-lookup"><span data-stu-id="ab8c7-136">Dynamic data binding in WPF</span></span>

<span data-ttu-id="ab8c7-137">既定では、対象となる UI 要素が初期化されたときにだけデータ バインディングが行われます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-137">By default, data binding occurs only when the target UI element is initialized.</span></span> <span data-ttu-id="ab8c7-138">これを *ワンタイム* バインドと呼びます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-138">This is called *one-time* binding.</span></span> <span data-ttu-id="ab8c7-139">ほとんどの場合、このバインドは十分には役立ちません。一般に、データ バインディングのソリューションでは、次のいずれかの方法を使用して実行時に変更が動的に反映されるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-139">For most purposes, this is insufficient; typically, a data-binding solution requires that the changes be dynamically propagated at run time using one of the following:</span></span>

- <span data-ttu-id="ab8c7-140">*一方向* のバインド。一方に対する変更が自動的に反映されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-140">*One-way* binding causes the changes to one side to be propagated automatically.</span></span> <span data-ttu-id="ab8c7-141">ソースに対する変更がターゲットに反映されるのが最も一般的ですが、その逆のパターンが役に立つ場合もあります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-141">Most commonly, changes to the source are reflected in the target, but the reverse can sometimes be useful.</span></span>

- <span data-ttu-id="ab8c7-142">*双方向* のバインド。ソースに対する変更がターゲットに、ターゲットに対する変更がソースに、それぞれ自動的に反映されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-142">In *two-way* binding, changes to the source are automatically propagated to the target, and changes to the target are automatically propagated to the source.</span></span>

<span data-ttu-id="ab8c7-143">一方向または双方向のバインドが行われるようにするには、変更通知のメカニズムをソースに実装する必要があります。たとえば、<xref:System.ComponentModel.INotifyPropertyChanged> インターフェイスを実装するか、サポートする各プロパティに対して *PropertyNameChanged* パターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-143">For one-way or two-way binding to occur, the source must implement a change notification mechanism, for example by implementing the <xref:System.ComponentModel.INotifyPropertyChanged> interface or by using a *PropertyNameChanged* pattern for each property supported.</span></span>

<span data-ttu-id="ab8c7-144">WPF のデータ バインディングの詳細については、「[データ バインディングの概要](/dotnet/framework/wpf/data/data-binding-wpf)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-144">For more information about data binding in WPF, see [Data Binding (WPF)](/dotnet/framework/wpf/data/data-binding-wpf).</span></span>

## <a name="dynamic-properties-in-linq-to-xml-classes"></a><span data-ttu-id="ab8c7-145">LINQ to XML クラスでの動的プロパティ</span><span class="sxs-lookup"><span data-stu-id="ab8c7-145">Dynamic properties in LINQ to XML classes</span></span>

<span data-ttu-id="ab8c7-146">ほとんどの LINQ to XML クラスは、WPF の動的データ ソースとして適切ではありません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-146">Most LINQ to XML classes do not qualify as proper WPF dynamic data sources.</span></span> <span data-ttu-id="ab8c7-147">最も有用な情報の一部は、プロパティではなく、メソッドを経由した場合にのみ取得でき、これらのクラスのプロパティでは変更通知が実装されません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-147">Some of the most useful information is available only through methods, not properties, and properties in these classes do not implement change notifications.</span></span> <span data-ttu-id="ab8c7-148">LINQ to XML では、WPF のデータ バインディングをサポートするために一連の *動的プロパティ* が公開されます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-148">To support WPF data binding, LINQ to XML exposes a set of *dynamic properties*.</span></span>

<span data-ttu-id="ab8c7-149">これらの動的プロパティは、<xref:System.Xml.Linq.XAttribute> クラスと <xref:System.Xml.Linq.XElement> クラスの既存のメソッドやプロパティと同じ機能を持つ特殊な実行時プロパティであり、</span><span class="sxs-lookup"><span data-stu-id="ab8c7-149">These dynamic properties are special run-time properties that duplicate the functionality of existing methods and properties in the <xref:System.Xml.Linq.XAttribute> and <xref:System.Xml.Linq.XElement> classes.</span></span> <span data-ttu-id="ab8c7-150">これらのクラスを WPF の動的データ ソースとして使用することのみを目的として追加されています。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-150">They were added to these classes solely to enable them to act as dynamic data sources for WPF.</span></span> <span data-ttu-id="ab8c7-151">この目的を満たすため、これらすべての動的プロパティに変更通知が実装されています。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-151">To meet this need, all these dynamic properties implement change notifications.</span></span> <span data-ttu-id="ab8c7-152">これらの動的プロパティの詳細については、次の「[LINQ to XML の動的プロパティ](linq-to-xml-dynamic-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-152">A detailed reference for these dynamic properties is provided in the next section, [LINQ to XML Dynamic Properties](linq-to-xml-dynamic-properties.md).</span></span>

> [!NOTE]
> <span data-ttu-id="ab8c7-153"><xref:System.Xml.Linq> 名前空間のさまざまなクラスに含まれている標準のパブリック プロパティの多くは、一方向のデータ バインドには使用できます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-153">Many of the standard public properties, found in the various classes in the <xref:System.Xml.Linq> namespace, can be used for one-time data binding.</span></span> <span data-ttu-id="ab8c7-154">ただし、既に説明したように、一方向のデータ バインドではソースもターゲットも動的に更新されません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-154">However, remember that neither the source nor the target will be dynamically updated under this scheme.</span></span>

### <a name="access-dynamic-properties"></a><span data-ttu-id="ab8c7-155">動的プロパティにアクセスする</span><span class="sxs-lookup"><span data-stu-id="ab8c7-155">Access dynamic properties</span></span>

<span data-ttu-id="ab8c7-156"><xref:System.Xml.Linq.XAttribute> クラスと <xref:System.Xml.Linq.XElement> クラスの動的プロパティには、標準のプロパティのようにアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-156">The dynamic properties in the <xref:System.Xml.Linq.XAttribute> and <xref:System.Xml.Linq.XElement> classes cannot be accessed like standard properties.</span></span> <span data-ttu-id="ab8c7-157">たとえば、C# などの CLR 準拠の言語で次のような操作を行うことはできません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-157">For example, in CLR-compliant languages such as C#, they cannot be:</span></span>

- <span data-ttu-id="ab8c7-158">コンパイル時に直接アクセスする。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-158">Accessed directly at compile time.</span></span> <span data-ttu-id="ab8c7-159">動的プロパティは、コンパイラや Visual Studio の IntelliSense からは見えません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-159">Dynamic properties are invisible to the compiler and to Visual Studio IntelliSense.</span></span>

- <span data-ttu-id="ab8c7-160">.NET リフレクションを使用して実行時に検出またはアクセスする。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-160">Discovered or accessed at run time using .NET reflection.</span></span> <span data-ttu-id="ab8c7-161">動的プロパティは実行時においても、CLR の基本的な意味でのプロパティではありません。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-161">Even at run time, they are not properties in the basic CLR sense.</span></span>

<span data-ttu-id="ab8c7-162">C# で動的プロパティへアクセスするには、実行時に <xref:System.ComponentModel> 名前空間の機能を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-162">In C#, dynamic properties can only be accessed at run time through facilities provided by the <xref:System.ComponentModel> namespace.</span></span>

<span data-ttu-id="ab8c7-163">一方、XML ソースでは、次のような形式の単純な表記法を使用して動的プロパティにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-163">In contrast, however, in an XML source dynamic properties can be accessed through a straightforward notation in the following form:</span></span>

```xml
<object>.<dynamic-property>
```

<span data-ttu-id="ab8c7-164">この 2 つのクラスの動的プロパティは、1 つの値またはインデクサーのいずれかに解決されます。1 つの値の場合は直接使用できますが、インデクサーの場合は、結果の値または値のコレクションを取得するにはインデックスを渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-164">The dynamic properties for these two classes either resolve to a value that can be used directly, or to an indexer that must be supplied with an index to obtain the resulting value or collection of values.</span></span> <span data-ttu-id="ab8c7-165">インデクサーの場合の構文は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-165">The latter syntax takes the form:</span></span>

```xml
<object>.<dynamic-property>[<index-value>]
```

<span data-ttu-id="ab8c7-166">詳細については、「[LINQ to XML の動的プロパティ](linq-to-xml-dynamic-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-166">For more information, see [LINQ to XML Dynamic Properties](linq-to-xml-dynamic-properties.md).</span></span>

<span data-ttu-id="ab8c7-167">WPF の動的バインドを実装するには、動的プロパティを <xref:System.Windows.Data> 名前空間 (特に <xref:System.Windows.Data.Binding> クラス) の機能と共に使用します。</span><span class="sxs-lookup"><span data-stu-id="ab8c7-167">To implement WPF dynamic binding, dynamic properties will be used with facilities provided by the <xref:System.Windows.Data> namespace, most notably the <xref:System.Windows.Data.Binding> class.</span></span>

## <a name="see-also"></a><span data-ttu-id="ab8c7-168">関連項目</span><span class="sxs-lookup"><span data-stu-id="ab8c7-168">See also</span></span>

- [<span data-ttu-id="ab8c7-169">LINQ to XML による WPF のデータ バインディング</span><span class="sxs-lookup"><span data-stu-id="ab8c7-169">WPF Data Binding with LINQ to XML</span></span>](wpf-data-binding-with-linq-to-xml-overview.md)
- [<span data-ttu-id="ab8c7-170">LINQ to XML の動的プロパティ</span><span class="sxs-lookup"><span data-stu-id="ab8c7-170">LINQ to XML Dynamic Properties</span></span>](linq-to-xml-dynamic-properties.md)
- [<span data-ttu-id="ab8c7-171">WPF の XAML</span><span class="sxs-lookup"><span data-stu-id="ab8c7-171">XAML in WPF</span></span>](../advanced/xaml-in-wpf.md)
- [<span data-ttu-id="ab8c7-172">データ バインド (WPF)</span><span class="sxs-lookup"><span data-stu-id="ab8c7-172">Data Binding (WPF)</span></span>](/dotnet/framework/wpf/data/data-binding-wpf)
- <span data-ttu-id="ab8c7-173">[ワークフロー マークアップの使用](/previous-versions/dotnet/netframework-3.5/ms735921(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="ab8c7-173">[Using Workflow Markup](/previous-versions/dotnet/netframework-3.5/ms735921(v=vs.90))</span></span>
