---
title: XAML のコレクションおよびコレクション型
ms.date: 03/30/2017
ms.assetid: 58f8e7c6-9a41-4f25-8551-c042f1315baa
ms.openlocfilehash: 2ec58026c605df31489c8aab4c4cc714dab11474
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "96985759"
---
# <a name="collections-and-collection-types-for-xaml"></a><span data-ttu-id="0f6b4-102">XAML のコレクションとコレクション型</span><span class="sxs-lookup"><span data-stu-id="0f6b4-102">Collections and collection types for XAML</span></span>

<span data-ttu-id="0f6b4-103">この記事では、コレクションをサポートするための型のプロパティを定義する方法と、親オブジェクトの要素またはプロパティ要素の子要素としてコレクション項目をインスタンス化するための XAML 構文をサポートする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-103">This article describes how to define properties of types that are intended to support a collection, and to support the XAML syntax for instantiating collection items as element children of a parent object element or property element.</span></span>

## <a name="xaml-collection-concepts"></a><span data-ttu-id="0f6b4-104">XAML コレクションの概念</span><span class="sxs-lookup"><span data-stu-id="0f6b4-104">XAML Collection Concepts</span></span>

<span data-ttu-id="0f6b4-105">概念的には、xaml オブジェクト要素または XAML プロパティ要素のスコープ内に複数の子項目がある XAML 内のリレーションシップは、コレクションとして実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-105">Conceptually, any relationship in XAML where there are multiple child items within the scope of a XAML object element or XAML property element must be implemented as a collection.</span></span> <span data-ttu-id="0f6b4-106">そのコレクションは、そのリレーションシップの親である XAML 型の特定の XAML プロパティに関連付けられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-106">That collection must be associated with a particular XAML property of the XAML type that is the parent in that relationship.</span></span> <span data-ttu-id="0f6b4-107">XAML プロセッサは、マークアップ内の各項目をバッキングコレクションプロパティの新しく追加された項目として割り当てることを想定しているため、プロパティはコレクションである必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-107">The property must be a collection because a XAML processor expects to assign each item in markup to be a newly added item of the backing collection property.</span></span>

<span data-ttu-id="0f6b4-108">XAML 言語レベルでは、コレクションサポートの正確な要件は完全には定義されていません。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-108">At the XAML language level, the exact requirements of collection support are not fully defined.</span></span> <span data-ttu-id="0f6b4-109">コレクションがリストまたはディクショナリ (両方ではない) のいずれかであるという概念は、XAML 言語レベルで定義されていますが、どちらのバッキング型でも、リストまたはディクショナリは、XAML 言語で定義されていません。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-109">The concept that a collection can be either a list or a dictionary(but not both) is defined at the XAML language level, but which backing types represent either lists or dictionaries is not defined by the XAML language.</span></span>

<span data-ttu-id="0f6b4-110">.NET XAML サービスでは、XAML コレクションのサポートの概念が、.NET バッキング型の観点からより明確に定義されています。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-110">In .NET XAML Services, the concept of XAML collection support is more clearly defined in terms of .NET backing types.</span></span> <span data-ttu-id="0f6b4-111">具体的には、コレクションの XAML サポートは、.net の一般的なプログラミングでリストおよびディクショナリに使用されるいくつかの .NET の概念と Api に基づいています。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-111">Specifically, the XAML support for collections is based on several .NET concepts and APIs that are used for lists and dictionaries in general .NET programming.</span></span>

1. <span data-ttu-id="0f6b4-112"><xref:System.Collections.IList>インターフェイスはリストコレクションを示します。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-112">The <xref:System.Collections.IList> interface indicates a list collection.</span></span>

2. <span data-ttu-id="0f6b4-113">インターフェイスは、 <xref:System.Collections.IDictionary> ディクショナリコレクションを示します。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-113">The <xref:System.Collections.IDictionary> interface indicates a dictionary collection.</span></span>

3. <span data-ttu-id="0f6b4-114"><xref:System.Array> は配列を表し、配列はメソッドをサポートし <xref:System.Collections.IList> ます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-114"><xref:System.Array> represents an array, and an array supports <xref:System.Collections.IList> methods.</span></span>

<span data-ttu-id="0f6b4-115">これらの各コレクションの概念では、.NET XAML サービスの XAML プロセッサは、 `Add` コレクションプロパティの型の特定のインスタンスに対してメソッドを呼び出すことを想定しています。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-115">In each of these collection concepts, a .NET XAML Services XAML processor expects to call the `Add` method on a specific instance of the collection property's type.</span></span> <span data-ttu-id="0f6b4-116">また、シリアル化のシナリオでは、XAML プロセッサによって、リスト、ディクショナリ、または配列内の各項目について、各コレクションに固有の "項目" の概念に基づいて、個別の XAML 型のインスタンスが生成されます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-116">Or, in a serialization scenario, a XAML processor produces discrete XAML-type instances for each item found in the list, dictionary, or array based on each collection's specific concept of "Items".</span></span> <span data-ttu-id="0f6b4-117">これらの項目は次のとおりです。 <xref:System.Collections.IList.Item%2A?displayProperty=nameWithType> ; <xref:System.Collections.IDictionary.Item%2A?displayProperty=nameWithType> 、の明示的な <xref:System.Array.System%23Collections%23IList%23Item%2A?displayProperty=nameWithType> <xref:System.Array> 。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-117">These items are: <xref:System.Collections.IList.Item%2A?displayProperty=nameWithType>; <xref:System.Collections.IDictionary.Item%2A?displayProperty=nameWithType>; the explicit <xref:System.Array.System%23Collections%23IList%23Item%2A?displayProperty=nameWithType> for <xref:System.Array>.</span></span>

## <a name="generic-collections"></a><span data-ttu-id="0f6b4-118">ジェネリックコレクション</span><span class="sxs-lookup"><span data-stu-id="0f6b4-118">Generic Collections</span></span>

<span data-ttu-id="0f6b4-119">ジェネリックコレクションは、一般的な .NET プログラミングに役立ち、XAML コレクションプロパティにも使用できます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-119">Generic collections can be useful for general .NET programming, and can also be used for XAML collection properties.</span></span> <span data-ttu-id="0f6b4-120">ただし、ジェネリックインターフェイス <xref:System.Collections.Generic.IList%601> と <xref:System.Collections.Generic.IDictionary%602> は、.Net xaml サービスの xaml プロセッサによって、非ジェネリックまたはと同等のものとして識別されません <xref:System.Collections.IList> <xref:System.Collections.IDictionary> 。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-120">However, the generic interfaces <xref:System.Collections.Generic.IList%601> and <xref:System.Collections.Generic.IDictionary%602> are not identified by .NET XAML Services XAML processors as being equivalent to the non-generic <xref:System.Collections.IList> or <xref:System.Collections.IDictionary>.</span></span> <span data-ttu-id="0f6b4-121">ジェネリックコレクションプロパティの型の推奨される方法は、インターフェイスを実装するのではなく、クラスまたはから派生することです <xref:System.Collections.Generic.List%601> <xref:System.Collections.Generic.Dictionary%602> 。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-121">Rather than implementing the interfaces, a recommended approach for generic collection property types is to derive from the classes <xref:System.Collections.Generic.List%601> or <xref:System.Collections.Generic.Dictionary%602>.</span></span> <span data-ttu-id="0f6b4-122">これらのクラスは、非ジェネリックインターフェイスを実装します。したがって、基本実装で XAML コレクションの予想されるサポートが含まれます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-122">These classes implement the non-generic interfaces and thus include the expected support for XAML collections in the base implementation.</span></span>

## <a name="read-only-collections-and-initialization-logic"></a><span data-ttu-id="0f6b4-123">Read-Only コレクションと初期化ロジック</span><span class="sxs-lookup"><span data-stu-id="0f6b4-123">Read-Only Collections and Initialization Logic</span></span>

<span data-ttu-id="0f6b4-124">.NET プログラミングでは、コレクションの値を保持する任意のプロパティを読み取り専用コレクションとして作成するための一般的なデザインパターンです。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-124">In .NET programming, it is a common design pattern to make any property that holds a value of a collection as a read-only collection.</span></span> <span data-ttu-id="0f6b4-125">このパターンでは、コレクションプロパティを所有するインスタンスが、コレクションに対して実行される処理をより適切に制御できるようにします。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-125">This pattern permits the instance that owns the collection property to better control what happens to the collection..</span></span> <span data-ttu-id="0f6b4-126">具体的には、プロパティを設定することによって、既存のコレクション全体が誤って置換されるのを防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-126">Specifically, the pattern prevents accidental replacement of the entire pre-existing collection by setting the property.</span></span> <span data-ttu-id="0f6b4-127">このパターンでは、呼び出し元によるコレクションへのアクセスは、コレクション型やなどの関連するコレクションインターフェイスでサポートされているメソッドまたはプロパティを呼び出すことによって行う必要があり <xref:System.Collections.IList> ます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-127">In this pattern, any access to the collection by callers should instead be made by calling methods or properties as supported by the collection type and/or the relevant collection interfaces such as <xref:System.Collections.IList>.</span></span>

<span data-ttu-id="0f6b4-128">このパターンを使用すると、読み取り専用のコレクションプロパティを公開するすべてのクラスは、最初に空のコレクションを保持するためにそのプロパティを初期化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-128">Using this pattern implies that any class that exposes a read-only collection property must first initialize that property to hold an empty collection.</span></span> <span data-ttu-id="0f6b4-129">通常、初期化は、クラスの構築動作の一部として実行されます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-129">Typically the initialization is performed as part of the construction behavior for the class.</span></span> <span data-ttu-id="0f6b4-130">Xaml では、通常、このようなロジックがパラメーターなしのコンストラクターによって参照されることが重要です。 XAML では、プロパティを処理する前にパラメーターなしのコンストラクターが一般に呼び出されるためです (コレクションプロパティなど)。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-130">To be useful for XAML, it is important that such logic is always referenced by the parameterless constructor, because XAML generally calls the parameterless constructor prior to processing the properties (collection properties or otherwise).</span></span>

## <a name="xaml-type-system-support-and-collections"></a><span data-ttu-id="0f6b4-131">XAML 型システムのサポートとコレクション</span><span class="sxs-lookup"><span data-stu-id="0f6b4-131">XAML Type System Support and Collections</span></span>

<span data-ttu-id="0f6b4-132">Xaml の解析とコレクションプロパティの設定またはシリアル化の基本的なメカニズムに加えて、.NET XAML サービスに実装されている XAML 型システムには、XAML のコレクションに関連するいくつかのデザイン機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-132">Beyond the basic mechanics of parsing XAML and populating or serializing collection properties, the XAML type system as implemented in .NET XAML Services includes several design features that pertain to collections in XAML.</span></span>

1. <span data-ttu-id="0f6b4-133"><xref:System.Xaml.XamlType.IsCollection%2A> xaml 型が XAML コレクションサポートを提供する型によってサポートされている場合に true を返します。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-133"><xref:System.Xaml.XamlType.IsCollection%2A> returns true if the XAML type is backed by a type that provides XAML collection support.</span></span>

2. <span data-ttu-id="0f6b4-134"><xref:System.Xaml.XamlType.IsDictionary%2A> とは、 <xref:System.Xaml.XamlType.IsArray%2A> XAML 型でサポートされているコレクションモードをさらに識別できます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-134"><xref:System.Xaml.XamlType.IsDictionary%2A> and <xref:System.Xaml.XamlType.IsArray%2A> can further identify which collection mode the XAML type supports.</span></span> <span data-ttu-id="0f6b4-135">.NET XAML サービスと XAML 型システムに基づくカスタム XAML プロセッサで、既存の実装に基づいていない場合は、どのコレクションモードが使用されているかを把握して <xref:System.Xaml.XamlWriter> おく必要があります。これは、どのメソッドを使用してコレクション処理を呼び出すかを知るためです。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-135">For custom XAML processors that are based on .NET XAML Services and the XAML type system but not based on existing <xref:System.Xaml.XamlWriter> implementations, knowing which collection mode is used might be necessary in order to know which method to invoke for collection processing.</span></span>

3. <span data-ttu-id="0f6b4-136">前の各プロパティ値は、XAML 型ののオーバーライドによって影響を受ける可能性があり <xref:System.Xaml.XamlType.LookupCollectionKind%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="0f6b4-136">Each of the previous property values is potentially influenced by overrides of <xref:System.Xaml.XamlType.LookupCollectionKind%2A> on a XAML type.</span></span>
